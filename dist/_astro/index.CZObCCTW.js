import{s as d,g as p}from"./_astro_assets.C5_CVhQn.js";import{c as h,r as g,m as u,u as k}from"./hoisted.BuEN0K9c.js";import"./astro/assets-service.3aFEbxKr.js";const E={src:"/_astro/question.D4LF0PKC.png",width:952,height:616,format:"png"},x={src:"/_astro/question.BuyNjina.png",width:946,height:582,format:"png"},f={src:"/_astro/question.CNmZgqmX.png",width:958,height:529,format:"png"},y={src:"/_astro/question.CdWZ-AHf.png",width:956,height:595,format:"png"},F={src:"/_astro/solution.BxGutl3z.png",width:710,height:125,format:"png"},_={src:"/_astro/question.CdfRLhKv.png",width:949,height:495,format:"png"},m={src:"/_astro/solution.CqqNXB79.png",width:1052,height:370,format:"png"},b={src:"/_astro/question.Da1iaKMg.png",width:948,height:614,format:"png"},v={src:"/_astro/upz.C2g3mM-C.gif",width:800,height:450,format:"gif"},A={src:"/_astro/question.BGJIE0a9.png",width:958,height:681,format:"png"},w={src:"/_astro/solution.DRuGFjYT.gif",width:800,height:450,format:"gif"},C={src:"/_astro/question.BX-UQJ4U.png",width:960,height:792,format:"png"},B={src:"/_astro/part1log.kv7akOGi.png",width:1342,height:1027,format:"png"},R={src:"/_astro/part2log.CUvMGrw9.png",width:1336,height:1029,format:"png"},D={src:"/_astro/part3log.ezD40MZv.png",width:1337,height:1036,format:"png"},S={src:"/_astro/question.Ca4ZVEOY.png",width:713,height:699,format:"png"},T={src:"/_astro/disass.MY8Sw7pT.png",width:348,height:406,format:"png"},G={src:"/_astro/solution.fxn2ZW8i.png",width:485,height:111,format:"png"},I={src:"/_astro/question.DG7V_clH.png",width:944,height:804,format:"png"},O=async function(o){const r={};{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/re/flag_hunt/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/re/flag_hunt/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:E,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/re/quantum/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/re/quantum/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:x,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/re/bininst1/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/re/bininst1/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:f,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/re/bininst2/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/re/bininst2/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:y,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/re/bininst2/solution\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/re/bininst2/solution.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:F,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/red/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/red/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:_,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/red/solution\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/red/solution.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:m,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/stepic/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/stepic/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:b,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/stepic/upz\\.gif[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/stepic/upz.gif_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:v,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/phantom/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/phantom/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:A,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/phantom/solution\\.gif[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/phantom/solution.gif_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:w,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/event/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/event/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:C,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/event/part1log\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/event/part1log.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:B,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/event/part2log\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/event/part2log.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:R,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/forensics/event/part3log\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/forensics/event/part3log.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:D,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/pwn/pie1/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/pwn/pie1/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:S,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/pwn/pie1/disass\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/pwn/pie1/disass.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:T,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/pwn/pie1/solution\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/pwn/pie1/solution.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:G,...i}),s++}}{const e=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/misc/yara/question\\.png[^"]*)"',"g");let n,s=0;for(;(n=e.exec(o))!==null;){const a="./assets/misc/yara/question.png_"+s,t=JSON.parse(n[1].replace(/&#x22;/g,'"')),{src:l,...i}=t;r[a]=await p({src:I,...i}),s++}}return r};async function M(o){return O(o).then(r=>o.replaceAll(/__ASTRO_IMAGE_="([^"]+)"/gm,(e,n)=>{const s=JSON.parse(n.replace(/&#x22;/g,'"')),a=s.src+"_"+s.index;r[a].srcSet&&r[a].srcSet.values.length>0&&(r[a].attributes.srcset=r[a].srcSet.attribute);const{index:t,...l}=r[a].attributes;return d({src:r[a].src,...l})}))}const c=await M(`<h2 id="reverse-engineering">[Reverse Engineering]<a class="anchor" href="#reverse-engineering">#</a></h2>
<h2 id="flag-hunters">Flag Hunters<a class="anchor" href="#flag-hunters">#</a></h2>
<h2 id=""><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/re/flag_hunt/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></h2>
<h3 id="goals">Goals<a class="anchor" href="#goals">#</a></h3>
<p>When the program starts, the lip is set to the line [VERSE], to retrieve the secret_intro, we need to alter the program so the lip variable set to the line of flag</p>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><pre><code><span class="line"><span>Pico warriors rising, puzzles laid bare,</span></span>
<span class="line"><span>Solving each challenge with precision and flair.</span></span>
<span class="line"><span>With unity and skill, flags we deliver,</span></span>
<span class="line"><span>The ether’s ours to conquer, '''\\</span></span>
<span class="line"><span>+ flag + '\\n'</span></span>
<span class="line"><span></span></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">plaintext</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="Pico warriors rising, puzzles laid bare,
Solving each challenge with precision and flair.
With unity and skill, flags we deliver,
The ether’s ours to conquer, &#x27;&#x27;&#x27;\\
+ flag + &#x27;\\n&#x27;
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<p>as shown, flag is at line 4</p>
<p>so passing index 0 to 3 will works, printing at the start of the lines at most line 4, index 3</p>
<p><strong>Payload:</strong> <code>&#x3C;any_text>;RETURN &#x3C;0 to 3>   (This is not injection)</code></p>
<h3 id="final-result">Final Result<a class="anchor" href="#final-result">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{70637h3r_f0r3v3r_c659e814}</code></p>
<h2 id="quantum-scrambler">Quantum Scrambler<a class="anchor" href="#quantum-scrambler">#</a></h2>
<h2 id="-1"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/re/quantum/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-1">#</a></h2>
<h3 id="goals-1">Goals<a class="anchor" href="#goals-1">#</a></h3>
<ol>
<li>Decrypt the encryption and retrieve the flag</li>
<li>Dissect the elements, and observe the scramble</li>
<li>Found final payload, decrypt with reversed scrambler</li>
</ol>
<hr>
<h3 id="solution">Solution<a class="anchor" href="#solution">#</a></h3>
<p>Reversed scrambler:</p>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><pre><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ast</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> flatten</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(lst):</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    flat </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> item </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> lst:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        if</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> isinstance</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(item, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">list</span><span style="color:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            flat.extend(flatten(item))</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        else</span><span style="color:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            flat.append(item)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> unscramble</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(cypher):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Outer list elements:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> index, element </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> enumerate</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(cypher):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">f</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Element </span><span style="color:#005CC5;--shiki-dark:#79B8FF">{</span><span style="color:#24292E;--shiki-dark:#E1E4E8">index</span><span style="color:#005CC5;--shiki-dark:#79B8FF">}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">: </span><span style="color:#005CC5;--shiki-dark:#79B8FF">{</span><span style="color:#24292E;--shiki-dark:#E1E4E8">element</span><span style="color:#005CC5;--shiki-dark:#79B8FF">}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"-"</span><span style="color:#D73A49;--shiki-dark:#F97583"> *</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 40</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    flat_list </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flatten(cypher)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    hex_strings </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [s </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flat_list </span><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> isinstance</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">and</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s.startswith(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"0x"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    flag_chars </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#005CC5;--shiki-dark:#79B8FF">chr</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">int</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(h, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">16</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)) </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> h </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hex_strings]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    flag </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.join(flag_chars)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flag</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">():</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    input_file </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> 'output.txt'</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    try</span><span style="color:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        with</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> open</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(input_file, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">'r'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">as</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> f:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            cipher_text </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> f.read()</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    except</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Exception</span><span style="color:#D73A49;--shiki-dark:#F97583"> as</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">f</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Error reading file </span><span style="color:#005CC5;--shiki-dark:#79B8FF">{</span><span style="color:#24292E;--shiki-dark:#E1E4E8">input_file</span><span style="color:#005CC5;--shiki-dark:#79B8FF">}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">: </span><span style="color:#005CC5;--shiki-dark:#79B8FF">{</span><span style="color:#24292E;--shiki-dark:#E1E4E8">e</span><span style="color:#005CC5;--shiki-dark:#79B8FF">}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    try</span><span style="color:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cypher </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ast.literal_eval(cipher_text)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    except</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Exception</span><span style="color:#D73A49;--shiki-dark:#F97583"> as</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Error interpreting cipher text:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, e)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    flag </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> unscramble(cypher)</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Recovered flag:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, flag)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> __name__</span><span style="color:#D73A49;--shiki-dark:#F97583"> ==</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> '__main__'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    main()</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">python</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="import ast

def flatten(lst):
    flat = []
    for item in lst:
        if isinstance(item, list):
            flat.extend(flatten(item))
        else:
            flat.append(item)
    return flat

def unscramble(cypher):
    print(&#x22;Outer list elements:&#x22;)
    for index, element in enumerate(cypher):
        print(f&#x22;Element {index}: {element}&#x22;)
    print(&#x22;-&#x22; * 40)
    
    flat_list = flatten(cypher)
    
    hex_strings = [s for s in flat_list if isinstance(s, str) and s.startswith(&#x22;0x&#x22;)]
    
    flag_chars = [chr(int(h, 16)) for h in hex_strings]
    flag = &#x27;&#x27;.join(flag_chars)
    return flag

def main():
    input_file = &#x27;output.txt&#x27;
    
    try:
        with open(input_file, &#x27;r&#x27;) as f:
            cipher_text = f.read()
    except Exception as e:
        print(f&#x22;Error reading file {input_file}: {e}&#x22;)
        return
    
    try:
        cypher = ast.literal_eval(cipher_text)
    except Exception as e:
        print(&#x22;Error interpreting cipher text:&#x22;, e)
        return
    
    flag = unscramble(cypher)
    print(&#x22;Recovered flag:&#x22;, flag)

if __name__ == &#x27;__main__&#x27;:
    main()
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<p><strong>Final payload:</strong> <code>[['0x70'],['0x69'],['0x63'],['0x6f'],['0x43'],['0x54'],['0x46'],['0x7b'],['0x70'],['0x79'],['0x74'],['0x68'],['0x6f'],['0x6e'],['0x5f'],['0x69'],['0x73'],['0x5f'],['0x77'],['0x65'],['0x69'],['0x72'],['0x64'],['0x65'],['0x66'],['0x38'],['0x65'],['0x61'],['0x30'],['0x63'],['0x66'],['0x7d']]</code><br>
<em>Save this as output.txt</em></p>
<h3 id="final-result-1">Final Result<a class="anchor" href="#final-result-1">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{python_is_weirdef8ea0cf}</code></p>
<h2 id="binary-instrumentation-1">Binary Instrumentation 1<a class="anchor" href="#binary-instrumentation-1">#</a></h2>
<h2 id="-2"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/re/bininst1/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-2">#</a></h2>
<h3 id="goals-2">Goals<a class="anchor" href="#goals-2">#</a></h3>
<ol>
<li>The binary bininst1.exe calls the <code>Sleep</code> function from kernel32.dll</li>
<li>Using frida-trace, we generate the handler scripts for API functions</li>
<li>Intercept any call to <code>Sleep</code>, in this case, under <code>KERNEL32.dll</code></li>
<li>We then set sleep duration to 0, avoiding the program from sleeping.</li>
</ol>
<hr>
<h3 id="solution-1">Solution<a class="anchor" href="#solution-1">#</a></h3>
<ol>
<li>Using frida-trace</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><pre><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">frida-trace</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> -i</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "Sleep"</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ./bininst1.exe</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">bash</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="frida-trace -i &#x22;Sleep&#x22; ./bininst1.exe
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol start="2">
<li>Intercept the handler, by modifying the handler generated, changing sleep duration to zero.</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="js"><pre><code><span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// KERNEL32.DLL/Sleep.js</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">var</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> sleepAddr </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> Module.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">getExportByName</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"kernel32.dll"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Sleep"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">Interceptor.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">attach</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(sleepAddr, {</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    onEnter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">: </span><span style="color:#D73A49;--shiki-dark:#F97583">function</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#E36209;--shiki-dark:#FFAB70">args</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // Log the original sleep duration (for debugging)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Original sleep time: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> args[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">toInt32</span><span style="color:#24292E;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // Change the sleep duration to 0</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        args[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">] </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> ptr</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">});</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">js</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="// KERNEL32.DLL/Sleep.js
var sleepAddr = Module.getExportByName(&#x22;kernel32.dll&#x22;, &#x22;Sleep&#x22;);
Interceptor.attach(sleepAddr, {
    onEnter: function (args) {
        // Log the original sleep duration (for debugging)
        console.log(&#x22;Original sleep time: &#x22; + args[0].toInt32());
        // Change the sleep duration to 0
        args[0] = ptr(0);
    }
});
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<h3 id="final-result-2">Final Result<a class="anchor" href="#final-result-2">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{r3d_1s_th3_ult1m4t3_cur3_f0r_54dn355_}</code></p>
<h2 id="binary-instrumentation-2">Binary Instrumentation 2<a class="anchor" href="#binary-instrumentation-2">#</a></h2>
<h2 id="-3"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/re/bininst2/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-3">#</a></h2>
<h3 id="goals-3">Goals<a class="anchor" href="#goals-3">#</a></h3>
<ol>
<li>Disassemble with ghidra, look for suspicious function</li>
<li>Hook with frida</li>
</ol>
<hr>
<h3 id="solution-2">Solution<a class="anchor" href="#solution-2">#</a></h3>
<ol>
<li>Deploy the script that hook suspicious function at <code>0x1dc0</code></li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="js"><pre><code><span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// Get the module base address for bininst2.exe</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">var</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> moduleBase </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> Module.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">findBaseAddress</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"bininst2.exe"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Module base address: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> moduleBase);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// Calculate the target function address using a known offset (update this offset as needed)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">var</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> funOffset </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0x1dc0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; </span><span style="color:#6A737D;--shiki-dark:#6A737D">// Adjust this based on your analysis</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">var</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> targetFunction </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> moduleBase.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">add</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(funOffset);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Hooking function at: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> targetFunction);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// Hook the target function (FUN_140001dc0)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">Interceptor.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">attach</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(targetFunction, {</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    onEnter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">: </span><span style="color:#D73A49;--shiki-dark:#F97583">function</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#E36209;--shiki-dark:#FFAB70">args</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // Assume:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        //   args[0] is a pointer to the flag data</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        //   args[1] is the length of the flag data</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        var</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> length </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> args[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">toInt32</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        try</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">            // Try to read the flag data as a UTF-8 string</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            var</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flagData </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> Memory.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">readUtf8String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(args[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">], length);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Flag data intercepted (utf8): "</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flagData);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        } </span><span style="color:#D73A49;--shiki-dark:#F97583">catch</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (err) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Error reading flag data as UTF-8: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err);</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">            // If reading as a string fails, dump the raw bytes</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Flag data intercepted (raw):</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\\n</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hexdump</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(args[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">], { length: length, header: </span><span style="color:#005CC5;--shiki-dark:#79B8FF">true</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ansi: </span><span style="color:#005CC5;--shiki-dark:#79B8FF">false</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> }));</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    onLeave</span><span style="color:#24292E;--shiki-dark:#E1E4E8">: </span><span style="color:#D73A49;--shiki-dark:#F97583">function</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#E36209;--shiki-dark:#FFAB70">retval</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        console.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">log</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"FUN_140001dc0 returned: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> retval);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">});</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">js</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="// Get the module base address for bininst2.exe
var moduleBase = Module.findBaseAddress(&#x22;bininst2.exe&#x22;);
console.log(&#x22;Module base address: &#x22; + moduleBase);

// Calculate the target function address using a known offset (update this offset as needed)
var funOffset = 0x1dc0; // Adjust this based on your analysis
var targetFunction = moduleBase.add(funOffset);
console.log(&#x22;Hooking function at: &#x22; + targetFunction);

// Hook the target function (FUN_140001dc0)
Interceptor.attach(targetFunction, {
    onEnter: function(args) {
        // Assume:
        //   args[0] is a pointer to the flag data
        //   args[1] is the length of the flag data
        var length = args[1].toInt32();
        try {
            // Try to read the flag data as a UTF-8 string
            var flagData = Memory.readUtf8String(args[0], length);
            console.log(&#x22;Flag data intercepted (utf8): &#x22; + flagData);
        } catch (err) {
            console.log(&#x22;Error reading flag data as UTF-8: &#x22; + err);
            // If reading as a string fails, dump the raw bytes
            console.log(&#x22;Flag data intercepted (raw):\\n&#x22; + hexdump(args[0], { length: length, header: true, ansi: false }));
        }
    },
    onLeave: function(retval) {
        console.log(&#x22;FUN_140001dc0 returned: &#x22; + retval);
    }
});
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol start="2">
<li>Run the script, then find for the flag</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><pre><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">frida</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF">scrip</span><span style="color:#24292E;--shiki-dark:#E1E4E8">t</span><span style="color:#D73A49;--shiki-dark:#F97583">></span><span style="color:#032F62;--shiki-dark:#9ECBFF">.js</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ./bininst2.exe</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">bash</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="frida -l <script>.js -f ./bininst2.exe
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<h3 id="final-result-3">Final Result<a class="anchor" href="#final-result-3">#</a></h3>
<hr>
<p>Base64 Encoded Flag:<br>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/re/bininst2/solution.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><br>
<strong>Flag:</strong> <code>picoCTF{fr1da_f0r_b1n_in5trum3nt4tion!_b21aef39}</code></p>
<h2 id="forensics">[Forensics]<a class="anchor" href="#forensics">#</a></h2>
<h2 id="red">RED<a class="anchor" href="#red">#</a></h2>
<h2 id="-4"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/red/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-4">#</a></h2>
<h3 id="goals-4">Goals<a class="anchor" href="#goals-4">#</a></h3>
<ol>
<li>Steganography, just upload to Aperi’Solve, ez flag</li>
</ol>
<hr>
<h3 id="solution-3">Solution<a class="anchor" href="#solution-3">#</a></h3>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/red/solution.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
<h3 id="final-result-4">Final Result<a class="anchor" href="#final-result-4">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{r3d_1s_th3_ult1m4t3_cur3_f0r_54dn355_}</code></p>
<h2 id="flags-are-stepic">flags are stepic<a class="anchor" href="#flags-are-stepic">#</a></h2>
<h2 id="-5"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/stepic/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-5">#</a></h2>
<h3 id="goals-5">Goals<a class="anchor" href="#goals-5">#</a></h3>
<ol>
<li>Find the country that doesn’t exist, the flag persists</li>
<li>Download the country flag</li>
<li>Search for stepic tool<br>
- <a href="https://shankaraman.wordpress.com/tag/ctf/" rel="nofollow, noopener, noreferrer" target="_blank">https://shankaraman.wordpress.com/tag/ctf/<span> ↗</span></a><br>
- <a href="https://code.tools/man/1/stepic/" rel="nofollow, noopener, noreferrer" target="_blank">https://code.tools/man/1/stepic/<span> ↗</span></a><br>
- <a href="https://pypi.org/project/stepic/" rel="nofollow, noopener, noreferrer" target="_blank">https://pypi.org/project/stepic/<span> ↗</span></a></li>
<li>Install stepic tool through pip</li>
<li>Unhide the flag</li>
</ol>
<hr>
<h3 id="solution-4">Solution<a class="anchor" href="#solution-4">#</a></h3>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/stepic/upz.gif&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
<h3 id="final-result-5">Final Result<a class="anchor" href="#final-result-5">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{fl4g_h45_fl4g57f48d94}</code></p>
<h2 id="ph4nt0m-1ntrud3r">Ph4nt0m 1ntrud3r<a class="anchor" href="#ph4nt0m-1ntrud3r">#</a></h2>
<h2 id="-6"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/phantom/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-6">#</a></h2>
<h3 id="goals-6">Goals<a class="anchor" href="#goals-6">#</a></h3>
<ol>
<li>Sort the time, since the reference times are messed up</li>
<li>Decode flag encoded in base64 in a series of consecutive packets</li>
</ol>
<hr>
<h3 id="solution-5">Solution<a class="anchor" href="#solution-5">#</a></h3>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/phantom/solution.gif&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
<h3 id="final-result-6">Final Result<a class="anchor" href="#final-result-6">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{1t_w4snt_th4t_34sy_tbh_4r_e5e8c78d}</code></p>
<h2 id="event-viewing">Event-Viewing<a class="anchor" href="#event-viewing">#</a></h2>
<h2 id="-7"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/event/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-7">#</a></h2>
<h3 id="goals-7">Goals<a class="anchor" href="#goals-7">#</a></h3>
<ol>
<li>Lookup 1033 Event, msi package install event id</li>
<li>Filter with date and time, look for suspicious event after 1033 happen within a short time range, about 20 minutes, found</li>
<li>“EVERY TIME” &#x3C;---(from question), so clear date and time filter, find with keyword “shutdown.exe” throughout whole event log</li>
</ol>
<hr>
<h3 id="solution-6">Solution<a class="anchor" href="#solution-6">#</a></h3>
<p>Part 1:<br>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/event/part1log.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><br>
<strong>Base64:</strong> <code>cGljb0NURntFdjNudF92aTN3djNyXw==</code>
<strong>Flag 1:</strong> <code>picoCTF{Ev3nt_vi3wv3r_</code></p>
<p>Part 2:<br>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/event/part2log.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}">
<strong>Base64:</strong> <code>MXNfYV9wcjN0dHlfdXMzZnVsXw==</code>
<strong>Flag 2:</strong> <code>1s_a_pr3tty_us3ful_</code></p>
<p>Part 3:<br>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/forensics/event/part3log.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><br>
<strong>Base64:</strong> <code>dDAwbF84MWJhM2ZlOX0=</code>
<strong>Flag 3:</strong> <code>t00l_81ba3fe9}</code></p>
<h3 id="final-result-7">Final Result<a class="anchor" href="#final-result-7">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{Ev3nt_vi3wv3r_1s_a_pr3tty_us3ful_t00l_81ba3fe9}</code></p>
<h2 id="binary-exploitation">[Binary Exploitation]<a class="anchor" href="#binary-exploitation">#</a></h2>
<h2 id="pie-time">PIE TIME<a class="anchor" href="#pie-time">#</a></h2>
<h2 id="-8"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/pwn/pie1/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-8">#</a></h2>
<h3 id="goals-8">Goals<a class="anchor" href="#goals-8">#</a></h3>
<ol>
<li>Call the win() function</li>
</ol>
<hr>
<h3 id="solution-7">Solution<a class="anchor" href="#solution-7">#</a></h3>
<ol>
<li>
<p>Disassemble with gdb<br>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/pwn/pie1/disass.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
</li>
<li>
<p>Observe the difference in address between main function and win function
The difference is 0x96, thus, to call the function’s address, it must always be <code>main()</code> - <code>0x96</code></p>
</li>
</ol>
<h3 id="final-result-8">Final Result<a class="anchor" href="#final-result-8">#</a></h3>
<hr>
<p>Launch the challenge<br>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/pwn/pie1/solution.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><br>
<strong>Flag:</strong> <code>picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_a267144a}</code></p>
<h2 id="general-skills">[General Skills]<a class="anchor" href="#general-skills">#</a></h2>
<h2 id="yararules0x100">YaraRules0x100<a class="anchor" href="#yararules0x100">#</a></h2>
<h2 id="-9"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/misc/yara/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-9">#</a></h2>
<h3 id="goals-9">Goals<a class="anchor" href="#goals-9">#</a></h3>
<ol>
<li>To detect malware sample with YARA rule while avoiding false positives and false negatives.</li>
<li>Malware can exist in packed(obfuscated) or unpacked(fully extracted in memory), the rule should cover both version.</li>
</ol>
<hr>
<h3 id="solution-8">Solution<a class="anchor" href="#solution-8">#</a></h3>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><pre><code><span class="line"><span>rule suspacked</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    strings:</span></span>
<span class="line"><span>        $packed_div = ".text$div"</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    condition:</span></span>
<span class="line"><span>        all of them</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rule susunpacked</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    strings:</span></span>
<span class="line"><span>        $unpacked_xml = "&#x3C;?xml version='1.0' encoding='UTF-8' standalone='yes'?>"</span></span>
<span class="line"><span>        $unpacked_dll = "ADVAPI32.dll"</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    condition:</span></span>
<span class="line"><span>        all of them</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">plaintext</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="rule suspacked
{
    strings:
        $packed_div = &#x22;.text$div&#x22;

    condition:
        all of them
}

rule susunpacked
{
    strings:
        $unpacked_xml = &#x22;<?xml version=&#x27;1.0&#x27; encoding=&#x27;UTF-8&#x27; standalone=&#x27;yes&#x27;?>&#x22;
        $unpacked_dll = &#x22;ADVAPI32.dll&#x22;

    condition:
        all of them
}
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol>
<li>Search for yara rule, follow the hint given, work with the format:
<a href="https://yara.readthedocs.io/en/stable/writingrules.html" rel="nofollow, noopener, noreferrer" target="_blank">https://yara.readthedocs.io/en/stable/writingrules.html<span> ↗</span></a></li>
<li>Open file with ghidra, search for strings, do trial and error</li>
</ol>
<h3 id="final-result-9">Final Result<a class="anchor" href="#final-result-9">#</a></h3>
<hr>
<p><strong>Flag:</strong> <code>picoCTF{yara_rul35_r0ckzzz_74c37bd8}</code></p>`),q={title:"picoCTF 2025",publishDate:"2025-03-11T00:00:00.000Z",description:"Writeups for picoCTF 2025",tags:["CTF","RE","Forensics","Pwn","Misc"],heroImage:{src:"./assets/picoCTFbanner.png",color:"#ffb0b0"},language:"English",minutesRead:"4 min read"},N="C:/Users/gr1d/Documents/gr1d-init/gr1d-init.github.io/src/content/post/picoctf2025/index.md",P=void 0;function U(){return`
## [Reverse Engineering]

## Flag Hunters  
![](./assets/re/flag_hunt/question.png)  
---
### Goals
When the program starts, the lip is set to the line [VERSE], to retrieve the secret_intro, we need to alter the program so the lip variable set to the line of flag
\`\`\`
Pico warriors rising, puzzles laid bare,
Solving each challenge with precision and flair.
With unity and skill, flags we deliver,
The ether’s ours to conquer, '''\\
+ flag + '\\n'
\`\`\`
as shown, flag is at line 4

so passing index 0 to 3 will works, printing at the start of the lines at most line 4, index 3

**Payload:** \`<any_text>;RETURN <0 to 3>   (This is not injection)\`
### Final Result
---
**Flag:** \`picoCTF{70637h3r_f0r3v3r_c659e814}\`


## Quantum Scrambler  
![](./assets/re/quantum/question.png)  
---
### Goals
1. Decrypt the encryption and retrieve the flag
2. Dissect the elements, and observe the scramble
3. Found final payload, decrypt with reversed scrambler
---
### Solution
Reversed scrambler:
\`\`\`python
import ast

def flatten(lst):
    flat = []
    for item in lst:
        if isinstance(item, list):
            flat.extend(flatten(item))
        else:
            flat.append(item)
    return flat

def unscramble(cypher):
    print("Outer list elements:")
    for index, element in enumerate(cypher):
        print(f"Element {index}: {element}")
    print("-" * 40)
    
    flat_list = flatten(cypher)
    
    hex_strings = [s for s in flat_list if isinstance(s, str) and s.startswith("0x")]
    
    flag_chars = [chr(int(h, 16)) for h in hex_strings]
    flag = ''.join(flag_chars)
    return flag

def main():
    input_file = 'output.txt'
    
    try:
        with open(input_file, 'r') as f:
            cipher_text = f.read()
    except Exception as e:
        print(f"Error reading file {input_file}: {e}")
        return
    
    try:
        cypher = ast.literal_eval(cipher_text)
    except Exception as e:
        print("Error interpreting cipher text:", e)
        return
    
    flag = unscramble(cypher)
    print("Recovered flag:", flag)

if __name__ == '__main__':
    main()
\`\`\` 
**Final payload:** \`[['0x70'],['0x69'],['0x63'],['0x6f'],['0x43'],['0x54'],['0x46'],['0x7b'],['0x70'],['0x79'],['0x74'],['0x68'],['0x6f'],['0x6e'],['0x5f'],['0x69'],['0x73'],['0x5f'],['0x77'],['0x65'],['0x69'],['0x72'],['0x64'],['0x65'],['0x66'],['0x38'],['0x65'],['0x61'],['0x30'],['0x63'],['0x66'],['0x7d']]\`  
_Save this as output.txt_

### Final Result
---
**Flag:** \`picoCTF{python_is_weirdef8ea0cf}\`


## Binary Instrumentation 1  
![](./assets/re/bininst1/question.png)  
---
### Goals
1. The binary bininst1.exe calls the \`Sleep\` function from kernel32.dll
2. Using frida-trace, we generate the handler scripts for API functions
3. Intercept any call to \`Sleep\`, in this case, under \`KERNEL32.dll\`
4. We then set sleep duration to 0, avoiding the program from sleeping.
---
### Solution
1. Using frida-trace
\`\`\`bash
frida-trace -i "Sleep" ./bininst1.exe
\`\`\`

2. Intercept the handler, by modifying the handler generated, changing sleep duration to zero.
\`\`\`js
// KERNEL32.DLL/Sleep.js
var sleepAddr = Module.getExportByName("kernel32.dll", "Sleep");
Interceptor.attach(sleepAddr, {
    onEnter: function (args) {
        // Log the original sleep duration (for debugging)
        console.log("Original sleep time: " + args[0].toInt32());
        // Change the sleep duration to 0
        args[0] = ptr(0);
    }
});
\`\`\`
### Final Result
---
**Flag:** \`picoCTF{r3d_1s_th3_ult1m4t3_cur3_f0r_54dn355_}\`


## Binary Instrumentation 2  
![](./assets/re/bininst2/question.png)  
---
### Goals
1. Disassemble with ghidra, look for suspicious function
2. Hook with frida
---
### Solution
1. Deploy the script that hook suspicious function at \`0x1dc0\`
\`\`\`js
// Get the module base address for bininst2.exe
var moduleBase = Module.findBaseAddress("bininst2.exe");
console.log("Module base address: " + moduleBase);

// Calculate the target function address using a known offset (update this offset as needed)
var funOffset = 0x1dc0; // Adjust this based on your analysis
var targetFunction = moduleBase.add(funOffset);
console.log("Hooking function at: " + targetFunction);

// Hook the target function (FUN_140001dc0)
Interceptor.attach(targetFunction, {
    onEnter: function(args) {
        // Assume:
        //   args[0] is a pointer to the flag data
        //   args[1] is the length of the flag data
        var length = args[1].toInt32();
        try {
            // Try to read the flag data as a UTF-8 string
            var flagData = Memory.readUtf8String(args[0], length);
            console.log("Flag data intercepted (utf8): " + flagData);
        } catch (err) {
            console.log("Error reading flag data as UTF-8: " + err);
            // If reading as a string fails, dump the raw bytes
            console.log("Flag data intercepted (raw):\\n" + hexdump(args[0], { length: length, header: true, ansi: false }));
        }
    },
    onLeave: function(retval) {
        console.log("FUN_140001dc0 returned: " + retval);
    }
});
\`\`\`
2. Run the script, then find for the flag
\`\`\`bash
frida -l <script>.js -f ./bininst2.exe
\`\`\`

### Final Result
---
Base64 Encoded Flag:  
![](./assets/re/bininst2/solution.png)  
**Flag:** \`picoCTF{fr1da_f0r_b1n_in5trum3nt4tion!_b21aef39}\`



## [Forensics]

## RED  
![](./assets/forensics/red/question.png)  
---
### Goals
1. Steganography, just upload to Aperi'Solve, ez flag
---
### Solution

![](./assets/forensics/red/solution.png)   

### Final Result
---
**Flag:** \`picoCTF{r3d_1s_th3_ult1m4t3_cur3_f0r_54dn355_}\`


## flags are stepic  
![](./assets/forensics/stepic/question.png)  
---
### Goals
1. Find the country that doesn't exist, the flag persists
2. Download the country flag
3. Search for stepic tool  
        - https://shankaraman.wordpress.com/tag/ctf/  
        - https://code.tools/man/1/stepic/  
        - https://pypi.org/project/stepic/  
4. Install stepic tool through pip
5. Unhide the flag
---
### Solution

![](./assets/forensics/stepic/upz.gif)  

### Final Result
---
**Flag:** \`picoCTF{fl4g_h45_fl4g57f48d94}\`


## Ph4nt0m 1ntrud3r  
![](./assets/forensics/phantom/question.png)  
---
### Goals
1. Sort the time, since the reference times are messed up
2. Decode flag encoded in base64 in a series of consecutive packets
---
### Solution

![](./assets/forensics/phantom/solution.gif)  

### Final Result
---
**Flag:** \`picoCTF{1t_w4snt_th4t_34sy_tbh_4r_e5e8c78d}\`


## Event-Viewing  
![](./assets/forensics/event/question.png)
---
### Goals
1. Lookup 1033 Event, msi package install event id
2. Filter with date and time, look for suspicious event after 1033 happen within a short time range, about 20 minutes, found
3. "EVERY TIME" <---(from question), so clear date and time filter, find with keyword "shutdown.exe" throughout whole event log
---
### Solution

Part 1:  
![](./assets/forensics/event/part1log.png)  
**Base64:** \`cGljb0NURntFdjNudF92aTN3djNyXw==\`
**Flag 1:** \`picoCTF{Ev3nt_vi3wv3r_\`

Part 2:  
![](./assets/forensics/event/part2log.png)
**Base64:** \`MXNfYV9wcjN0dHlfdXMzZnVsXw==\`
**Flag 2:** \`1s_a_pr3tty_us3ful_\`

Part 3:  
![](./assets/forensics/event/part3log.png)  
**Base64:** \`dDAwbF84MWJhM2ZlOX0=\`
**Flag 3:** \`t00l_81ba3fe9}\`


### Final Result
---
**Flag:** \`picoCTF{Ev3nt_vi3wv3r_1s_a_pr3tty_us3ful_t00l_81ba3fe9}\`



## [Binary Exploitation]

## PIE TIME  
![](./assets/pwn/pie1/question.png)
---
### Goals
1. Call the win() function
---
### Solution

1. Disassemble with gdb  
![](./assets/pwn/pie1/disass.png)  

2. Observe the difference in address between main function and win function
The difference is 0x96, thus, to call the function's address, it must always be \`main()\` - \`0x96\`

### Final Result
---
Launch the challenge  
![](./assets/pwn/pie1/solution.png)  
**Flag:** \`picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_a267144a}\`



## [General Skills]

## YaraRules0x100  
![](./assets/misc/yara/question.png)  
---
### Goals
1. To detect malware sample with YARA rule while avoiding false positives and false negatives.
2. Malware can exist in packed(obfuscated) or unpacked(fully extracted in memory), the rule should cover both version.
---
### Solution

\`\`\`
rule suspacked
{
    strings:
        $packed_div = ".text$div"

    condition:
        all of them
}

rule susunpacked
{
    strings:
        $unpacked_xml = "<?xml version='1.0' encoding='UTF-8' standalone='yes'?>"
        $unpacked_dll = "ADVAPI32.dll"

    condition:
        all of them
}
\`\`\`  
1. Search for yara rule, follow the hint given, work with the format:
https://yara.readthedocs.io/en/stable/writingrules.html
2. Open file with ghidra, search for strings, do trial and error
### Final Result
---
**Flag:** \`picoCTF{yara_rul35_r0ckzzz_74c37bd8}\`
`}function K(){return c}function J(){return[{depth:2,slug:"reverse-engineering",text:"[Reverse Engineering]"},{depth:2,slug:"flag-hunters",text:"Flag Hunters"},{depth:2,slug:"",text:""},{depth:3,slug:"goals",text:"Goals"},{depth:3,slug:"final-result",text:"Final Result"},{depth:2,slug:"quantum-scrambler",text:"Quantum Scrambler"},{depth:2,slug:"-1",text:""},{depth:3,slug:"goals-1",text:"Goals"},{depth:3,slug:"solution",text:"Solution"},{depth:3,slug:"final-result-1",text:"Final Result"},{depth:2,slug:"binary-instrumentation-1",text:"Binary Instrumentation 1"},{depth:2,slug:"-2",text:""},{depth:3,slug:"goals-2",text:"Goals"},{depth:3,slug:"solution-1",text:"Solution"},{depth:3,slug:"final-result-2",text:"Final Result"},{depth:2,slug:"binary-instrumentation-2",text:"Binary Instrumentation 2"},{depth:2,slug:"-3",text:""},{depth:3,slug:"goals-3",text:"Goals"},{depth:3,slug:"solution-2",text:"Solution"},{depth:3,slug:"final-result-3",text:"Final Result"},{depth:2,slug:"forensics",text:"[Forensics]"},{depth:2,slug:"red",text:"RED"},{depth:2,slug:"-4",text:""},{depth:3,slug:"goals-4",text:"Goals"},{depth:3,slug:"solution-3",text:"Solution"},{depth:3,slug:"final-result-4",text:"Final Result"},{depth:2,slug:"flags-are-stepic",text:"flags are stepic"},{depth:2,slug:"-5",text:""},{depth:3,slug:"goals-5",text:"Goals"},{depth:3,slug:"solution-4",text:"Solution"},{depth:3,slug:"final-result-5",text:"Final Result"},{depth:2,slug:"ph4nt0m-1ntrud3r",text:"Ph4nt0m 1ntrud3r"},{depth:2,slug:"-6",text:""},{depth:3,slug:"goals-6",text:"Goals"},{depth:3,slug:"solution-5",text:"Solution"},{depth:3,slug:"final-result-6",text:"Final Result"},{depth:2,slug:"event-viewing",text:"Event-Viewing"},{depth:2,slug:"-7",text:""},{depth:3,slug:"goals-7",text:"Goals"},{depth:3,slug:"solution-6",text:"Solution"},{depth:3,slug:"final-result-7",text:"Final Result"},{depth:2,slug:"binary-exploitation",text:"[Binary Exploitation]"},{depth:2,slug:"pie-time",text:"PIE TIME"},{depth:2,slug:"-8",text:""},{depth:3,slug:"goals-8",text:"Goals"},{depth:3,slug:"solution-7",text:"Solution"},{depth:3,slug:"final-result-8",text:"Final Result"},{depth:2,slug:"general-skills",text:"[General Skills]"},{depth:2,slug:"yararules0x100",text:"YaraRules0x100"},{depth:2,slug:"-9",text:""},{depth:3,slug:"goals-9",text:"Goals"},{depth:3,slug:"solution-8",text:"Solution"},{depth:3,slug:"final-result-9",text:"Final Result"}]}const H=h((o,r,e)=>{const{layout:n,...s}=q;return s.file=N,s.url=P,g`${u()}${k(c)}`});export{H as Content,K as compiledContent,H as default,N as file,q as frontmatter,J as getHeadings,U as rawContent,P as url};
