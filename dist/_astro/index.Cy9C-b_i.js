import{s as k,g as p}from"./_astro_assets.CDFu4n8r.js";import{c as d,r as h,m as E,u as y}from"./hoisted.CCtZBuQU.js";import"./astro/assets-service.Bu9dkybA.js";const F={src:"/_astro/question.CsKevD8e.png",width:491,height:465,format:"png"},g={src:"/_astro/fileinfo.M0rQw6qx.png",width:807,height:86,format:"png"},u={src:"/_astro/entryFunction.CWV-0_iT.png",width:1919,height:816,format:"png"},f={src:"/_astro/renamed.DrgXV0fX.png",width:861,height:821,format:"png"},x={src:"/_astro/googleColab._N2KWjEW.png",width:725,height:397,format:"png"},C={src:"/_astro/finalResult.qhUeuRYg.png",width:1053,height:650,format:"png"},m={src:"/_astro/question.C2dTRo4D.png",width:498,height:678,format:"png"},_={src:"/_astro/files.7fkW2lfk.png",width:927,height:177,format:"png"},A={src:"/_astro/diff1.C2R5bIcs.png",width:802,height:946,format:"png"},b={src:"/_astro/diff2.DWSPMhxC.png",width:799,height:948,format:"png"},D={src:"/_astro/solution.B9WEySsu.png",width:704,height:46,format:"png"},B={src:"/_astro/question.X0swvYMg.png",width:494,height:519,format:"png"},v={src:"/_astro/logfile.CDQ6qzsm.png",width:697,height:243,format:"png"},w={src:"/_astro/correctSeed.Cj_PW3GY.png",width:659,height:509,format:"png"},T={src:"/_astro/flag.fZPoe3fx.png",width:1036,height:112,format:"png"},S=async function(l){const o={};{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/bakamitai/question\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/bakamitai/question.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:F,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/bakamitai/fileinfo\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/bakamitai/fileinfo.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:g,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/bakamitai/entryFunction\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/bakamitai/entryFunction.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:u,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/bakamitai/renamed\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/bakamitai/renamed.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:f,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/bakamitai/googleColab\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/bakamitai/googleColab.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:x,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/bakamitai/finalResult\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/bakamitai/finalResult.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:C,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/cryptic/question\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/cryptic/question.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:m,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/cryptic/files\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/cryptic/files.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:_,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/cryptic/diff1\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/cryptic/diff1.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:A,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/cryptic/diff2\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/cryptic/diff2.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:b,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/cryptic/solution\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/cryptic/solution.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:D,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/genz/question\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/genz/question.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:B,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/genz/logfile\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/genz/logfile.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:v,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/genz/correctSeed\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/genz/correctSeed.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:w,...r}),s++}}{const i=new RegExp('__ASTRO_IMAGE_="([^"]*\\./assets/genz/flag\\.png[^"]*)"',"g");let a,s=0;for(;(a=i.exec(l))!==null;){const n="./assets/genz/flag.png_"+s,e=JSON.parse(a[1].replace(/&#x22;/g,'"')),{src:t,...r}=e;o[n]=await p({src:T,...r}),s++}}return o};async function R(l){return S(l).then(o=>l.replaceAll(/__ASTRO_IMAGE_="([^"]+)"/gm,(i,a)=>{const s=JSON.parse(a.replace(/&#x22;/g,'"')),n=s.src+"_"+s.index;o[n].srcSet&&o[n].srcSet.values.length>0&&(o[n].attributes.srcset=o[n].srcSet.attribute);const{index:e,...t}=o[n].attributes;return k({src:o[n].src,...t})}))}const c=await R(`<h2 id="reverse-engineering">Reverse Engineering<a class="anchor" href="#reverse-engineering">#</a></h2>
<hr>
<h2 id="baka-mitai">Baka Mitai<a class="anchor" href="#baka-mitai">#</a></h2>
<h2 id=""><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/bakamitai/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></h2>
<h3 id="goals">Goals<a class="anchor" href="#goals">#</a></h3>
<ol>
<li>Check file information using checksec</li>
<li>Decompilation using ghidra, check the flagchecker flow</li>
<li>Deploy angr script, perform symbolic analysis
<em>References:</em>
<a href="https://shinmao.github.io/posts/2022/02/bp1/" rel="nofollow, noopener, noreferrer" target="_blank">https://shinmao.github.io/posts/2022/02/bp1/<span> ↗</span></a>
<a href="https://github.com/jakespringer/angr_ctf" rel="nofollow, noopener, noreferrer" target="_blank">https://github.com/jakespringer/angr_ctf<span> ↗</span></a></li>
</ol>
<hr>
<ol>
<li>Using checksec, we realised the file is dynamcally linked, stripped
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/bakamitai/fileinfo.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></li>
<li>Decompile with ghidra, since it’s stripped, we have to find the main entry from entry function
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/bakamitai/entryFunction.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></li>
<li>Try to rename the variables, functions, for ease of analysis
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/bakamitai/renamed.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}">
From this point, we could know that:</li>
</ol>
<ul>
<li>The program proceed if flag length == 0x37 (55 characters),</li>
<li>It go through complex transformation, lastly doing flagcheck and tell if the flag provide from user input is correct</li>
<li>Well, we are not going to reverse and go through these complex transformations.</li>
<li>Instead, we will deploy angr script, automate this process</li>
</ul>
<ol start="4">
<li>I deployed the angr script on google colab
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/bakamitai/googleColab.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><pre><code><span class="line"><span style="color:#B31D28;font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">pip install angr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> angr</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> claripy</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Define binary path and parameters</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">input_file_path </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> './chall'</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">flag_length </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 55</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">known_string </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> 'EQCTF{'</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">FIND_ADDR</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#D73A49;--shiki-dark:#F97583"> 0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">4016e4</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">AVOID_ADDR</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">4016fa</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">40159f</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">START_ADDR</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#D73A49;--shiki-dark:#F97583"> 0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">40158d</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Load the binary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">proj </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> angr.Project(input_file_path, </span><span style="color:#E36209;--shiki-dark:#FFAB70">auto_load_libs</span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF">False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#E36209;--shiki-dark:#FFAB70">main_opts</span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8">{</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'base_addr'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">: </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">400000</span><span style="color:#24292E;--shiki-dark:#E1E4E8">})</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Create symbolic characters for the flag</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">known_chars </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [claripy.BVV((known_string[i])) </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> range</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(known_string))]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">flag_chars </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [claripy.BVS(</span><span style="color:#D73A49;--shiki-dark:#F97583">f</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"flag_</span><span style="color:#005CC5;--shiki-dark:#79B8FF">{</span><span style="color:#24292E;--shiki-dark:#E1E4E8">i</span><span style="color:#005CC5;--shiki-dark:#79B8FF">}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">8</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> range</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(flag_length </span><span style="color:#D73A49;--shiki-dark:#F97583">-</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(known_string))]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">flag </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> claripy.Concat(</span><span style="color:#D73A49;--shiki-dark:#F97583">*</span><span style="color:#24292E;--shiki-dark:#E1E4E8">known_chars </span><span style="color:#D73A49;--shiki-dark:#F97583">+</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flag_chars)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Create a blank state at the start address</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">state </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> proj.factory.blank_state(</span><span style="color:#E36209;--shiki-dark:#FFAB70">addr</span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF">START_ADDR</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">state.options.add(angr.options.</span><span style="color:#005CC5;--shiki-dark:#79B8FF">LAZY_SOLVES</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">state.options.add(angr.options.</span><span style="color:#005CC5;--shiki-dark:#79B8FF">UNICORN</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Define the address of the local variable \`local_58\` (e.g., \`[RBP - 0x50]\`)</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Assume RBP is initialized to some stack base (common for blank_state)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">stack_base </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> state.regs.rbp</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">local_58_address </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> stack_base </span><span style="color:#D73A49;--shiki-dark:#F97583">-</span><span style="color:#D73A49;--shiki-dark:#F97583"> 0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">50</span><span style="color:#6A737D;--shiki-dark:#6A737D">  # Offset to local variable \`local_58\`</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Store the symbolic flag into \`local_58\`</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">state.memory.store(local_58_address, flag)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Pass the address of \`local_58\` in RDI (used by __isoc23_scanf)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">state.regs.rdi </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> local_58_address</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Add constraints to ensure flag is printable (ASCII range 0x20 to 0x7e)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> k </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flag_chars:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    state.solver.add(k </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="color:#D73A49;--shiki-dark:#F97583"> 0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">7f</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># Less than 0x7f (127)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    state.solver.add(k </span><span style="color:#D73A49;--shiki-dark:#F97583">></span><span style="color:#D73A49;--shiki-dark:#F97583"> 0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">20</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)  </span><span style="color:#6A737D;--shiki-dark:#6A737D"># Greater than 0x20 (32)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Create a simulation manager</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">sim_manager </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> proj.factory.simulation_manager(state)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Explore paths to find the target address while avoiding bad paths</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">sim_manager.explore(</span><span style="color:#E36209;--shiki-dark:#FFAB70">find</span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF">FIND_ADDR</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#E36209;--shiki-dark:#FFAB70">avoid</span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF">AVOID_ADDR</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># Check if a solution was found</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(sim_manager.found) </span><span style="color:#D73A49;--shiki-dark:#F97583">></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    # Evaluate the symbolic flag to retrieve its value</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    solution </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> sim_manager.found[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">].solver.eval(flag, </span><span style="color:#E36209;--shiki-dark:#FFAB70">cast_to</span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF">bytes</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">f</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Flag found: </span><span style="color:#005CC5;--shiki-dark:#79B8FF">{</span><span style="color:#24292E;--shiki-dark:#E1E4E8">solution.decode()</span><span style="color:#005CC5;--shiki-dark:#79B8FF">}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">else</span><span style="color:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"No solution found."</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">python</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="!pip install angr

import angr
import claripy
  
# Define binary path and parameters
input_file_path = &#x27;./chall&#x27;
flag_length = 55
known_string = &#x27;EQCTF{&#x27;
FIND_ADDR = 0x4016e4
AVOID_ADDR = [0x4016fa, 0x40159f]
START_ADDR = 0x40158d

# Load the binary
proj = angr.Project(input_file_path, auto_load_libs=False, main_opts={&#x27;base_addr&#x27;: 0x400000})
  
# Create symbolic characters for the flag
known_chars = [claripy.BVV((known_string[i])) for i in range(len(known_string))]
flag_chars = [claripy.BVS(f&#x22;flag_{i}&#x22;, 8) for i in range(flag_length - len(known_string))]
flag = claripy.Concat(*known_chars + flag_chars)

# Create a blank state at the start address
state = proj.factory.blank_state(addr=START_ADDR)
state.options.add(angr.options.LAZY_SOLVES)
state.options.add(angr.options.UNICORN)
  
# Define the address of the local variable &#x60;local_58&#x60; (e.g., &#x60;[RBP - 0x50]&#x60;)
# Assume RBP is initialized to some stack base (common for blank_state)
stack_base = state.regs.rbp
local_58_address = stack_base - 0x50  # Offset to local variable &#x60;local_58&#x60;
  
# Store the symbolic flag into &#x60;local_58&#x60;
state.memory.store(local_58_address, flag)

# Pass the address of &#x60;local_58&#x60; in RDI (used by __isoc23_scanf)
state.regs.rdi = local_58_address

# Add constraints to ensure flag is printable (ASCII range 0x20 to 0x7e)
for k in flag_chars:
    state.solver.add(k < 0x7f)  # Less than 0x7f (127)
    state.solver.add(k > 0x20)  # Greater than 0x20 (32)

# Create a simulation manager
sim_manager = proj.factory.simulation_manager(state)

# Explore paths to find the target address while avoiding bad paths
sim_manager.explore(find=FIND_ADDR, avoid=AVOID_ADDR)

# Check if a solution was found
if len(sim_manager.found) > 0:
    # Evaluate the symbolic flag to retrieve its value
    solution = sim_manager.found[0].solver.eval(flag, cast_to=bytes)
    print(f&#x22;Flag found: {solution.decode()}&#x22;)
else:
    print(&#x22;No solution found.&#x22;)
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<p>To understand how this script works in details, do check out the references provided, and follow the tutorials.
The scripting is hard, it just follow a strict template.
However, there are few points worth mentioning,</p>
<ul>
<li>the start_addr, should be placed after scanf CALL instruction, better if placed at where complex transformation start</li>
<li>symbolic stack approach is an important point, specifically for this challenge where you can’t just use a universal angr template</li>
<li>blank_state should be used instead of entry_state because strlen is called before scanf, if you define the sim manager with entry state, it will waste extra resources going through strlen library call. Within all libc library call, there are mutex locks which angr cant deal with, which is why you need to hook the function and simulate user input with symbolic memory</li>
<li>find_addr, is the desired memory location where the instance of “Correct” is reached</li>
<li>avoid_addr are the memory location to avoid such as “Wrong”</li>
</ul>
<h3 id="final-result">Final Result<a class="anchor" href="#final-result">#</a></h3>
<hr>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/bakamitai/finalResult.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
<h2 id="cryptic-token-diffusion">Cryptic Token Diffusion<a class="anchor" href="#cryptic-token-diffusion">#</a></h2>
<h2 id="-1"><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/cryptic/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"><a class="anchor" href="#-1">#</a></h2>
<h3 id="goals-1">Goals<a class="anchor" href="#goals-1">#</a></h3>
<ol>
<li>Perform binary diffing</li>
<li>Match index number to correspond characters</li>
<li>Rearrange the character in ascending order according to their index number
<em>Tools required: vbindiff</em></li>
</ol>
<hr>
<ol>
<li>Viewing the files, there are two versions of application. Thus, we try to compare the difference between versions.
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/cryptic/files.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><pre><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">vbindiff</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> vault-v1.0.0.elf</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> vault-1.2.1.elf</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">bash</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="vbindiff vault-v1.0.0.elf vault-1.2.1.elf
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol start="2">
<li>Observe the pattern, we realised that there are two parts showing difference in binaries:
<ul>
<li>vault-v1.0.0 acts as the index number, corresponds to the characters in vault-v1.2.1
<em>Part 1</em>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/cryptic/diff1.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}">
<em>Part 2</em>
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/cryptic/diff2.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></li>
</ul>
</li>
</ol>
<ul>
<li>List out all the correspondence, sort them in ascending order, turn to ASCII and print it out</li>
</ul>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><pre><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">v1p1 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#005CC5;--shiki-dark:#79B8FF">12</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">28</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">23</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">15</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">21</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">10</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">4</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">27</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">5</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">26</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">8</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">17</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">18</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">25</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">v1p2 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#005CC5;--shiki-dark:#79B8FF">9</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">13</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">7</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">24</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">6</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">11</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">14</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">22</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">29</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">16</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">19</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">20</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">v2p1 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">37</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">67</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">45</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">31</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">62</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">5f</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">30</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">46</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">6e</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">7b</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">31</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">74</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">6e</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">54</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">34</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">66</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">v2p2 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">72</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">30</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">6E</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">66</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">31</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">43</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">51</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">5F</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">5F</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">64</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">7D</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">31</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">72</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#D73A49;--shiki-dark:#F97583">0x</span><span style="color:#005CC5;--shiki-dark:#79B8FF">79</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">v1 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> v1p1 </span><span style="color:#D73A49;--shiki-dark:#F97583">+</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> v1p2</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">v2 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> v2p1 </span><span style="color:#D73A49;--shiki-dark:#F97583">+</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> v2p2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">pairs </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> sorted</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">zip</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(v1, v2))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">sorted_ascii </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.join(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">chr</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(value) </span><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> _, value </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> pairs)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(sorted_ascii)</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">python</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="v1p1 = [12, 28, 0, 23, 15, 21, 10, 4, 27, 5, 26, 8, 17, 3, 18, 25]
v1p2 = [9, 13, 7, 24, 6, 2, 1, 11, 14, 22, 29, 16, 19, 20]

v2p1 = [0x37, 0x67, 0x45, 0x31, 0x62, 0x5f, 0x30, 0x46, 0x6e, 0x7b, 0x31, 0x74, 0x6e, 0x54, 0x34, 0x66]
v2p2 = [0x72, 0x30, 0x6E, 0x66, 0x31, 0x43, 0x51, 0x5F, 0x5F, 0x64, 0x7D, 0x31, 0x72, 0x79]

v1 = v1p1 + v1p2
v2 = v2p1 + v2p2

pairs = sorted(zip(v1, v2))

sorted_ascii = &#x27;&#x27;.join(chr(value) for _, value in pairs)

print(sorted_ascii)
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<h3 id="final-result-1">Final Result<a class="anchor" href="#final-result-1">#</a></h3>
<hr>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/cryptic/solution.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
<h2 id="gen-z">Gen Z<a class="anchor" href="#gen-z">#</a></h2>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/genz/question.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>
<hr>
<h3 id="goals-2">Goals<a class="anchor" href="#goals-2">#</a></h3>
<ol>
<li>Deobfuscate the C code, you may choose not to as it just work</li>
<li>Observe the log, figure out how the flag might relate to the timestamp</li>
</ol>
<hr>
<ol>
<li>Opening the file, you will see obfuscated C code</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="cpp"><pre><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rn</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> finna</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> cap</span><span style="color:#D73A49;--shiki-dark:#F97583"> !=</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> mf</span><span style="color:#D73A49;--shiki-dark:#F97583"> *</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> bouta</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> ongod</span><span style="color:#D73A49;--shiki-dark:#F97583"> ++</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> sheesh</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> fr</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> bet</span><span style="color:#D73A49;--shiki-dark:#F97583"> if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> chief</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> main</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> yikes</span><span style="color:#D73A49;--shiki-dark:#F97583"> break</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> deadass</span><span style="color:#D73A49;--shiki-dark:#F97583"> return</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> skibidi</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> tho</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> bussin</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> cout</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> huh</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> true</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#define</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> lit</span><span style="color:#D73A49;--shiki-dark:#F97583"> double</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;iostream></span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;fstream></span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;iomanip></span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;openssl/sha.h></span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">using </span><span style="color:#D73A49;--shiki-dark:#F97583">namespace</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> std</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">unsigned</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> int</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> seed</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() </span><span style="color:#6F42C1;--shiki-dark:#B392F0">skibidi</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    deadass</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> static_cast</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">unsigned</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> int</span><span style="color:#24292E;--shiki-dark:#E1E4E8">>(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">time</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">nullptr</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)) </span><span style="color:#6F42C1;--shiki-dark:#B392F0">rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">tho</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">string</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> getHash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">lit</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> value</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#6F42C1;--shiki-dark:#B392F0">skibidi</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    ostringstream</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> oss</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    oss</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> fr</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> setprecision</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(17) </span><span style="color:#6F42C1;--shiki-dark:#B392F0">fr</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> value</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    string</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> text</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> finna</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> oss</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() </span><span style="color:#6F42C1;--shiki-dark:#B392F0">rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    unsigned</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> char</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">[</span><span style="color:#6F42C1;--shiki-dark:#B392F0">SHA256_DIGEST_LENGTH</span><span style="color:#24292E;--shiki-dark:#E1E4E8">] </span><span style="color:#6F42C1;--shiki-dark:#B392F0">rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    SHA256</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">reinterpret_cast</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">const</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> unsigned</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> char</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> mf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">>(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">text</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">c_str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()), </span><span style="color:#6F42C1;--shiki-dark:#B392F0">text</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">size</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(), </span><span style="color:#6F42C1;--shiki-dark:#B392F0">hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#6F42C1;--shiki-dark:#B392F0">rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    ostringstream</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> result</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">int</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> i</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> finna</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> 0 </span><span style="color:#6F42C1;--shiki-dark:#B392F0">rn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> i</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> sheesh</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> SHA256_DIGEST_LENGTH</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> i</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> ongod</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        result fr hex fr </span><span style="color:#6F42C1;--shiki-dark:#B392F0">setw</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) fr </span><span style="color:#6F42C1;--shiki-dark:#B392F0">setfill</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'0'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) fr </span><span style="color:#D73A49;--shiki-dark:#F97583">static_cast&#x3C;int></span><span style="color:#24292E;--shiki-dark:#E1E4E8">(hash[i]) rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    tho</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    deadass result.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">tho</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">int</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> chief</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() skibidi</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    while</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">huh</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) skibidi</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s finna </span><span style="color:#6F42C1;--shiki-dark:#B392F0">seed</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        srand</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s) rn</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x finna </span><span style="color:#6F42C1;--shiki-dark:#B392F0">rand</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() rn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        string flag finna </span><span style="color:#6F42C1;--shiki-dark:#B392F0">getHash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(x) rn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        bet</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (flag.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">find</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"a9ba358e"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) cap </span><span style="color:#6F42C1;--shiki-dark:#B392F0">string</span><span style="color:#24292E;--shiki-dark:#E1E4E8">::npos) {  </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            ofstream </span><span style="color:#6F42C1;--shiki-dark:#B392F0">outfile</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"./flag"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) rn</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">            bet</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (outfile.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">is_open</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                outfile fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"EQCTF{"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fr flag fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"tho"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                outfile.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">close</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            tho</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            yikes rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        tho</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        time_t</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> now finna </span><span style="color:#6F42C1;--shiki-dark:#B392F0">time</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        tm mf ltm finna </span><span style="color:#6F42C1;--shiki-dark:#B392F0">localtime</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(bouta now) rn</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        bussin fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"["</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fr </span><span style="color:#005CC5;--shiki-dark:#79B8FF">1900</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ltm->tm_year fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"-"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        bussin fr </span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ltm->tm_mon fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"-"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        bussin fr ltm->tm_mday fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"] "</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        bussin fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"🤓☝️ erm actually, you're incorrect 🥺👉👈: "</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fr x fr endl rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    tho</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    bussin fr </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Good job Skibidisigma 🐺🥶 - Adolf Rizzler 🗿"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fr endl rn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    deadass </span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> rn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">tho</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">cpp</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="#define rn ;
#define finna =
#define cap !=
#define mf *
#define bouta &#x26;
#define ongod ++
#define sheesh <
#define fr <<
#define bet if
#define chief main
#define yikes break
#define deadass return
#define skibidi {
#define tho }
#define bussin cout
#define huh true
#define lit double

#include <iostream>
#include <fstream>
#include <iomanip>
#include <openssl/sha.h>


using namespace std rn

unsigned int seed() skibidi
    deadass static_cast<unsigned int>(time(nullptr)) rn
tho

string getHash(lit value) skibidi
    ostringstream oss rn
    oss fr setprecision(17) fr value rn
    string text finna oss.str() rn
    unsigned char hash[SHA256_DIGEST_LENGTH] rn
    SHA256(reinterpret_cast<const unsigned char mf>(text.c_str()), text.size(), hash) rn
    ostringstream result rn
    for (int i finna 0 rn i sheesh SHA256_DIGEST_LENGTH rn i ongod) {
        result fr hex fr setw(2) fr setfill(&#x27;0&#x27;) fr static_cast<int>(hash[i]) rn
    tho
    deadass result.str() rn
tho


int chief() skibidi
    while (huh) skibidi
        unsigned int s finna seed() rn
        srand(s) rn
        int x finna rand() rn

        string flag finna getHash(x) rn

        bet (flag.find(&#x22;a9ba358e&#x22;) cap string::npos) {  
            ofstream outfile(&#x22;./flag&#x22;) rn
            bet (outfile.is_open()) {
                outfile fr &#x22;EQCTF{&#x22; fr flag fr &#x22;tho&#x22; rn
                outfile.close() rn
            tho
            yikes rn
        tho
  
        time_t now finna time(0) rn
        tm mf ltm finna localtime(bouta now) rn


        bussin fr &#x22;[&#x22; fr 1900 + ltm->tm_year fr &#x22;-&#x22; rn
        bussin fr 1 + ltm->tm_mon fr &#x22;-&#x22; rn
        bussin fr ltm->tm_mday fr &#x22;] &#x22; rn
        bussin fr &#x22;🤓☝️ erm actually, you&#x27;re incorrect 🥺👉👈: &#x22; fr x fr endl rn
    tho
    bussin fr &#x22;Good job Skibidisigma 🐺🥶 - Adolf Rizzler 🗿&#x22; fr endl rn

    deadass 0 rn
tho
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<p>Just replace the obfuscated part with its actual symbol as shown in define list, to ease our debugging process.</p>
<ol start="2">
<li>After debobfuscation,</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="cpp"><pre><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;iostream></span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;fstream></span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;iomanip></span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">#include</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> &#x3C;openssl/sha.h></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">using</span><span style="color:#D73A49;--shiki-dark:#F97583"> namespace</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> std</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> seed</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#D73A49;--shiki-dark:#F97583"> static_cast&#x3C;unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int></span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">time</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">nullptr</span><span style="color:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">string</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> getHash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">double</span><span style="color:#E36209;--shiki-dark:#FFAB70"> value</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ostringstream oss;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    oss </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> setprecision</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">17</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> value;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    string text </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> oss.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> char</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hash[SHA256_DIGEST_LENGTH];</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    SHA256</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">reinterpret_cast&#x3C;const</span><span style="color:#D73A49;--shiki-dark:#F97583"> unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> char</span><span style="color:#D73A49;--shiki-dark:#F97583"> *></span><span style="color:#24292E;--shiki-dark:#E1E4E8">(text.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">c_str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()), text.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">size</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(), hash);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ostringstream result;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; i </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> SHA256_DIGEST_LENGTH; i</span><span style="color:#D73A49;--shiki-dark:#F97583">++</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        result </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hex </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> setw</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> setfill</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'0'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#D73A49;--shiki-dark:#F97583"> static_cast&#x3C;int></span><span style="color:#24292E;--shiki-dark:#E1E4E8">(hash[i]);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> result.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">int</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    while</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#005CC5;--shiki-dark:#79B8FF">true</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> seed</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        srand</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rand</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        string flag </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> getHash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(x);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (flag.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">find</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"a9ba358e"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">!=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> string</span><span style="color:#24292E;--shiki-dark:#E1E4E8">::npos)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            ofstream </span><span style="color:#6F42C1;--shiki-dark:#B392F0">outfile</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"./flag"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (outfile.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">is_open</span><span style="color:#24292E;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                outfile </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "EQCTF{"</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flag </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                outfile.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">close</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            break</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        time_t</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> now </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> time</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        tm </span><span style="color:#D73A49;--shiki-dark:#F97583">*</span><span style="color:#24292E;--shiki-dark:#E1E4E8">ltm </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> localtime</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">now);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cout </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "["</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 1900</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ltm->tm_year </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "-"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cout </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="color:#D73A49;--shiki-dark:#F97583"> +</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ltm->tm_mon </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "-"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cout </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ltm->tm_mday </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "] "</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cout </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "🤓☝️ erm actually, you're incorrect 🥺👉👈: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> endl;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    cout </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "Good job Skibidisigma 🐺🥶 - Adolf Rizzler 🗿"</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">cpp</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="#include <iostream>
#include <fstream>
#include <iomanip>
#include <openssl/sha.h>
  
using namespace std;
  
unsigned int seed()
{
    return static_cast<unsigned int>(time(nullptr));
}

string getHash(double value)
{
    ostringstream oss;
    oss << setprecision(17) << value;
    string text = oss.str();
  
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256(reinterpret_cast<const unsigned char *>(text.c_str()), text.size(), hash);

    ostringstream result;
    for (int i = 0; i < SHA256_DIGEST_LENGTH; i++)
    {
        result << hex << setw(2) << setfill(&#x27;0&#x27;) << static_cast<int>(hash[i]);
    }
    return result.str();
}


int main()
{
    while (true)
    {
        unsigned int s = seed();
        srand(s);
        int x = rand();

        string flag = getHash(x);

        if (flag.find(&#x22;a9ba358e&#x22;) != string::npos)
        {
            ofstream outfile(&#x22;./flag&#x22;);
            if (outfile.is_open())
            {
                outfile << &#x22;EQCTF{&#x22; << flag << &#x22;}&#x22;;
                outfile.close();
            }
            break;
        }

        time_t now = time(0);
        tm *ltm = localtime(&#x26;now);
  
        cout << &#x22;[&#x22; << 1900 + ltm->tm_year << &#x22;-&#x22;;
        cout << 1 + ltm->tm_mon << &#x22;-&#x22;;
        cout << ltm->tm_mday << &#x22;] &#x22;;
        cout << &#x22;🤓☝️ erm actually, you&#x27;re incorrect 🥺👉👈: &#x22; << x << endl;
    }
    cout << &#x22;Good job Skibidisigma 🐺🥶 - Adolf Rizzler 🗿&#x22; << x << endl;

    return 0;
}
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol start="3">
<li>Observing the logfile,
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/genz/logfile.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}">
We should focus that flag is paired up on [2025-01-01], so we should patch our c code to run on that time stamp, and which we just need to fix the seed() function
Part that affect:</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="cpp"><pre><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> seed</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">srand</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">int</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> rand</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">cpp</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="unsigned int s = seed();
srand(s);
int x = rand();
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<p>Patched seed() function:</p>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="cpp"><pre><code><span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// Brute-force timestamp around 2025-01-01</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> seed</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    static</span><span style="color:#D73A49;--shiki-dark:#F97583"> time_t</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> test_time </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 1735689600</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span><span style="color:#6A737D;--shiki-dark:#6A737D">  // 2025-01-01 00:00:00 UTC</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (test_time </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 1735775999</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span><span style="color:#6A737D;--shiki-dark:#6A737D">  // 2025-01-01 23:59:59 UTC</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span><span style="color:#D73A49;--shiki-dark:#F97583"> static_cast&#x3C;unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int></span><span style="color:#24292E;--shiki-dark:#E1E4E8">(test_time</span><span style="color:#D73A49;--shiki-dark:#F97583">++</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    return</span><span style="color:#D73A49;--shiki-dark:#F97583"> static_cast&#x3C;unsigned</span><span style="color:#D73A49;--shiki-dark:#F97583"> int></span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">time</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">nullptr</span><span style="color:#24292E;--shiki-dark:#E1E4E8">));</span><span style="color:#6A737D;--shiki-dark:#6A737D"> // Fallback to current time</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// -------------------------------------------</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// You may also add the line for Found correct seed: to indicate that you found correct seed</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (flag.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">find</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"a9ba358e"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">!=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> string</span><span style="color:#24292E;--shiki-dark:#E1E4E8">::npos) { </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ofstream </span><span style="color:#6F42C1;--shiki-dark:#B392F0">outfile</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"./flag"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">); </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (outfile.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">is_open</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()) { </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        outfile </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "EQCTF{"</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> flag </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        outfile.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">close</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(); } </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cout </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "Found correct seed: "</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x3C;</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> endl; </span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        break</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">...</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">...</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">cpp</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="// Brute-force timestamp around 2025-01-01
unsigned int seed() {
    static time_t test_time = 1735689600;  // 2025-01-01 00:00:00 UTC
    if (test_time <= 1735775999) {  // 2025-01-01 23:59:59 UTC
        return static_cast<unsigned int>(test_time++);
    }
    return static_cast<unsigned int>(time(nullptr)); // Fallback to current time
}
// -------------------------------------------
// You may also add the line for Found correct seed: to indicate that you found correct seed
if (flag.find(&#x22;a9ba358e&#x22;) != string::npos) { 
    ofstream outfile(&#x22;./flag&#x22;); 
    if (outfile.is_open()) { 
        outfile << &#x22;EQCTF{&#x22; << flag << &#x22;}&#x22;; 
        outfile.close(); } 
        cout << &#x22;Found correct seed: &#x22; << s << endl; 
        break; 
    }
...
...
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol start="4">
<li>Due to the usage of openssl/sha.h, we should compile our C++ file as below</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><pre><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">g++</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> -o</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> gen_z</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> chall.cpp</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> -lssl</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> -lcrypto</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">bash</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="g++ -o gen_z chall.cpp -lssl -lcrypto
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<ol start="5">
<li>Execute the file</li>
</ol>
<div class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><pre><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">./gen_z</span></span>
<span class="line"></span></code></pre><span class="language transition-opacity duration-300 absolute top-3 right-3 text-sm text-muted-foreground select-none">bash</span><button class="copy transition-opacity duration-300 opacity-0 absolute top-3 right-3 text-muted-foreground p-1 box-content border border-border rounded bg-primary-foreground" data-code="./gen_z
" onclick="
          navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)
        "><div class="ready"><svg class="size-5"><use href="/icons/code.svg#mingcute-clipboard-line"></use></svg></div><div class="success hidden"><svg class="size-5"><use href="/icons/code.svg#mingcute-file-check-line"></use></svg></div></button></div>
<h3 id="final-result-2">Final result<a class="anchor" href="#final-result-2">#</a></h3>
<hr>
<p><img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/genz/correctSeed.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}">
And flag file is generated:
<img __ASTRO_IMAGE_="{&#x22;src&#x22;:&#x22;./assets/genz/flag.png&#x22;,&#x22;alt&#x22;:&#x22;&#x22;,&#x22;index&#x22;:0}"></p>`),I={title:"EQCTF 2025",publishDate:"2025-01-25T00:00:00.000Z",description:"Writeups for Equilibrium Solo CTF 2025",tags:["CTF","RE"],heroImage:{src:"./assets/eqctfbanner.png",color:"#bababa"},language:"English",minutesRead:"8 min read"},G="C:/Users/gr1d/Documents/gr1d-init/gr1d-init.github.io/src/content/post/eqctf2025/index.md",O=void 0;function N(){return`
## Reverse Engineering
---
## Baka Mitai
![](./assets/bakamitai/question.png) 
---
### Goals
1. Check file information using checksec
2. Decompilation using ghidra, check the flagchecker flow
3. Deploy angr script, perform symbolic analysis
_References:_
https://shinmao.github.io/posts/2022/02/bp1/
https://github.com/jakespringer/angr_ctf
---
1. Using checksec, we realised the file is dynamcally linked, stripped
![](./assets/bakamitai/fileinfo.png) 
2. Decompile with ghidra, since it's stripped, we have to find the main entry from entry function
![](./assets/bakamitai/entryFunction.png) 
3. Try to rename the variables, functions, for ease of analysis
![](./assets/bakamitai/renamed.png) 
From this point, we could know that:
- The program proceed if flag length == 0x37 (55 characters), 
- It go through complex transformation, lastly doing flagcheck and tell if the flag provide from user input is correct
- Well, we are not going to reverse and go through these complex transformations.
- Instead, we will deploy angr script, automate this process

4. I deployed the angr script on google colab
![](./assets/bakamitai/googleColab.png) 
\`\`\`python
!pip install angr

import angr
import claripy
  
# Define binary path and parameters
input_file_path = './chall'
flag_length = 55
known_string = 'EQCTF{'
FIND_ADDR = 0x4016e4
AVOID_ADDR = [0x4016fa, 0x40159f]
START_ADDR = 0x40158d

# Load the binary
proj = angr.Project(input_file_path, auto_load_libs=False, main_opts={'base_addr': 0x400000})
  
# Create symbolic characters for the flag
known_chars = [claripy.BVV((known_string[i])) for i in range(len(known_string))]
flag_chars = [claripy.BVS(f"flag_{i}", 8) for i in range(flag_length - len(known_string))]
flag = claripy.Concat(*known_chars + flag_chars)

# Create a blank state at the start address
state = proj.factory.blank_state(addr=START_ADDR)
state.options.add(angr.options.LAZY_SOLVES)
state.options.add(angr.options.UNICORN)
  
# Define the address of the local variable \`local_58\` (e.g., \`[RBP - 0x50]\`)
# Assume RBP is initialized to some stack base (common for blank_state)
stack_base = state.regs.rbp
local_58_address = stack_base - 0x50  # Offset to local variable \`local_58\`
  
# Store the symbolic flag into \`local_58\`
state.memory.store(local_58_address, flag)

# Pass the address of \`local_58\` in RDI (used by __isoc23_scanf)
state.regs.rdi = local_58_address

# Add constraints to ensure flag is printable (ASCII range 0x20 to 0x7e)
for k in flag_chars:
    state.solver.add(k < 0x7f)  # Less than 0x7f (127)
    state.solver.add(k > 0x20)  # Greater than 0x20 (32)

# Create a simulation manager
sim_manager = proj.factory.simulation_manager(state)

# Explore paths to find the target address while avoiding bad paths
sim_manager.explore(find=FIND_ADDR, avoid=AVOID_ADDR)

# Check if a solution was found
if len(sim_manager.found) > 0:
    # Evaluate the symbolic flag to retrieve its value
    solution = sim_manager.found[0].solver.eval(flag, cast_to=bytes)
    print(f"Flag found: {solution.decode()}")
else:
    print("No solution found.")
\`\`\`
To understand how this script works in details, do check out the references provided, and follow the tutorials.
The scripting is hard, it just follow a strict template.
However, there are few points worth mentioning, 
- the start_addr, should be placed after scanf CALL instruction, better if placed at where complex transformation start
- symbolic stack approach is an important point, specifically for this challenge where you can't just use a universal angr template
- blank_state should be used instead of entry_state because strlen is called before scanf, if you define the sim manager with entry state, it will waste extra resources going through strlen library call. Within all libc library call, there are mutex locks which angr cant deal with, which is why you need to hook the function and simulate user input with symbolic memory
- find_addr, is the desired memory location where the instance of "Correct" is reached
- avoid_addr are the memory location to avoid such as "Wrong"

### Final Result
---
![](./assets/bakamitai/finalResult.png) 



## Cryptic Token Diffusion
![](./assets/cryptic/question.png) 
---
### Goals
1. Perform binary diffing
2. Match index number to correspond characters
3. Rearrange the character in ascending order according to their index number
_Tools required: vbindiff_
---
1. Viewing the files, there are two versions of application. Thus, we try to compare the difference between versions.
![](./assets/cryptic/files.png) 
\`\`\`bash
vbindiff vault-v1.0.0.elf vault-1.2.1.elf
\`\`\`

2. Observe the pattern, we realised that there are two parts showing difference in binaries:
    - vault-v1.0.0 acts as the index number, corresponds to the characters in vault-v1.2.1
_Part 1_
![](./assets/cryptic/diff1.png) 
_Part 2_
![](./assets/cryptic/diff2.png) 
- List out all the correspondence, sort them in ascending order, turn to ASCII and print it out
\`\`\`python
v1p1 = [12, 28, 0, 23, 15, 21, 10, 4, 27, 5, 26, 8, 17, 3, 18, 25]
v1p2 = [9, 13, 7, 24, 6, 2, 1, 11, 14, 22, 29, 16, 19, 20]

v2p1 = [0x37, 0x67, 0x45, 0x31, 0x62, 0x5f, 0x30, 0x46, 0x6e, 0x7b, 0x31, 0x74, 0x6e, 0x54, 0x34, 0x66]
v2p2 = [0x72, 0x30, 0x6E, 0x66, 0x31, 0x43, 0x51, 0x5F, 0x5F, 0x64, 0x7D, 0x31, 0x72, 0x79]

v1 = v1p1 + v1p2
v2 = v2p1 + v2p2

pairs = sorted(zip(v1, v2))

sorted_ascii = ''.join(chr(value) for _, value in pairs)

print(sorted_ascii)
\`\`\`
### Final Result
---
![](./assets/cryptic/solution.png) 



## Gen Z
 ![](./assets/genz/question.png) 
 
---
### Goals
1. Deobfuscate the C code, you may choose not to as it just work
2. Observe the log, figure out how the flag might relate to the timestamp
---
1. Opening the file, you will see obfuscated C code
\`\`\`cpp
#define rn ;
#define finna =
#define cap !=
#define mf *
#define bouta &
#define ongod ++
#define sheesh <
#define fr <<
#define bet if
#define chief main
#define yikes break
#define deadass return
#define skibidi {
#define tho }
#define bussin cout
#define huh true
#define lit double

#include <iostream>
#include <fstream>
#include <iomanip>
#include <openssl/sha.h>


using namespace std rn

unsigned int seed() skibidi
    deadass static_cast<unsigned int>(time(nullptr)) rn
tho

string getHash(lit value) skibidi
    ostringstream oss rn
    oss fr setprecision(17) fr value rn
    string text finna oss.str() rn
    unsigned char hash[SHA256_DIGEST_LENGTH] rn
    SHA256(reinterpret_cast<const unsigned char mf>(text.c_str()), text.size(), hash) rn
    ostringstream result rn
    for (int i finna 0 rn i sheesh SHA256_DIGEST_LENGTH rn i ongod) {
        result fr hex fr setw(2) fr setfill('0') fr static_cast<int>(hash[i]) rn
    tho
    deadass result.str() rn
tho


int chief() skibidi
    while (huh) skibidi
        unsigned int s finna seed() rn
        srand(s) rn
        int x finna rand() rn

        string flag finna getHash(x) rn

        bet (flag.find("a9ba358e") cap string::npos) {  
            ofstream outfile("./flag") rn
            bet (outfile.is_open()) {
                outfile fr "EQCTF{" fr flag fr "tho" rn
                outfile.close() rn
            tho
            yikes rn
        tho
  
        time_t now finna time(0) rn
        tm mf ltm finna localtime(bouta now) rn


        bussin fr "[" fr 1900 + ltm->tm_year fr "-" rn
        bussin fr 1 + ltm->tm_mon fr "-" rn
        bussin fr ltm->tm_mday fr "] " rn
        bussin fr "🤓☝️ erm actually, you're incorrect 🥺👉👈: " fr x fr endl rn
    tho
    bussin fr "Good job Skibidisigma 🐺🥶 - Adolf Rizzler 🗿" fr endl rn

    deadass 0 rn
tho
\`\`\`
Just replace the obfuscated part with its actual symbol as shown in define list, to ease our debugging process.

2. After debobfuscation,
\`\`\`cpp
#include <iostream>
#include <fstream>
#include <iomanip>
#include <openssl/sha.h>
  
using namespace std;
  
unsigned int seed()
{
    return static_cast<unsigned int>(time(nullptr));
}

string getHash(double value)
{
    ostringstream oss;
    oss << setprecision(17) << value;
    string text = oss.str();
  
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256(reinterpret_cast<const unsigned char *>(text.c_str()), text.size(), hash);

    ostringstream result;
    for (int i = 0; i < SHA256_DIGEST_LENGTH; i++)
    {
        result << hex << setw(2) << setfill('0') << static_cast<int>(hash[i]);
    }
    return result.str();
}


int main()
{
    while (true)
    {
        unsigned int s = seed();
        srand(s);
        int x = rand();

        string flag = getHash(x);

        if (flag.find("a9ba358e") != string::npos)
        {
            ofstream outfile("./flag");
            if (outfile.is_open())
            {
                outfile << "EQCTF{" << flag << "}";
                outfile.close();
            }
            break;
        }

        time_t now = time(0);
        tm *ltm = localtime(&now);
  
        cout << "[" << 1900 + ltm->tm_year << "-";
        cout << 1 + ltm->tm_mon << "-";
        cout << ltm->tm_mday << "] ";
        cout << "🤓☝️ erm actually, you're incorrect 🥺👉👈: " << x << endl;
    }
    cout << "Good job Skibidisigma 🐺🥶 - Adolf Rizzler 🗿" << x << endl;

    return 0;
}
\`\`\`

3. Observing the logfile, 
![](./assets/genz/logfile.png) 
We should focus that flag is paired up on \\[2025-01-01], so we should patch our c code to run on that time stamp, and which we just need to fix the seed() function
Part that affect:
\`\`\`cpp
unsigned int s = seed();
srand(s);
int x = rand();
\`\`\`
Patched seed() function:
\`\`\`cpp
// Brute-force timestamp around 2025-01-01
unsigned int seed() {
    static time_t test_time = 1735689600;  // 2025-01-01 00:00:00 UTC
    if (test_time <= 1735775999) {  // 2025-01-01 23:59:59 UTC
        return static_cast<unsigned int>(test_time++);
    }
    return static_cast<unsigned int>(time(nullptr)); // Fallback to current time
}
// -------------------------------------------
// You may also add the line for Found correct seed: to indicate that you found correct seed
if (flag.find("a9ba358e") != string::npos) { 
    ofstream outfile("./flag"); 
    if (outfile.is_open()) { 
        outfile << "EQCTF{" << flag << "}"; 
        outfile.close(); } 
        cout << "Found correct seed: " << s << endl; 
        break; 
    }
...
...
\`\`\`

4. Due to the usage of openssl/sha.h, we should compile our C++ file as below
\`\`\`bash
g++ -o gen_z chall.cpp -lssl -lcrypto
\`\`\`
5. Execute the file
\`\`\`bash
./gen_z
\`\`\`

### Final result
---
![](./assets/genz/correctSeed.png) 
And flag file is generated:
![](./assets/genz/flag.png) `}function P(){return c}function M(){return[{depth:2,slug:"reverse-engineering",text:"Reverse Engineering"},{depth:2,slug:"baka-mitai",text:"Baka Mitai"},{depth:2,slug:"",text:""},{depth:3,slug:"goals",text:"Goals"},{depth:3,slug:"final-result",text:"Final Result"},{depth:2,slug:"cryptic-token-diffusion",text:"Cryptic Token Diffusion"},{depth:2,slug:"-1",text:""},{depth:3,slug:"goals-1",text:"Goals"},{depth:3,slug:"final-result-1",text:"Final Result"},{depth:2,slug:"gen-z",text:"Gen Z"},{depth:3,slug:"goals-2",text:"Goals"},{depth:3,slug:"final-result-2",text:"Final result"}]}const j=d((l,o,i)=>{const{layout:a,...s}=I;return s.file=G,s.url=O,h`${E()}${y(c)}`});export{j as Content,P as compiledContent,j as default,G as file,I as frontmatter,M as getHeadings,N as rawContent,O as url};
